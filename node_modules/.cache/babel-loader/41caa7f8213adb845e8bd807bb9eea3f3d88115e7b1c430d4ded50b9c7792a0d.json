{"ast":null,"code":"import { noop } from \"./chunk-7FNX7RWY.mjs\";\nimport { isDevelopmentEnvironment } from \"./chunk-QMOEH4QX.mjs\";\n\n// src/utils/createDeferredPromise.ts\nvar createDeferredPromise = () => {\n  let resolve = noop;\n  let reject = noop;\n  const promise = new Promise((res, rej) => {\n    resolve = res;\n    reject = rej;\n  });\n  return {\n    promise,\n    resolve,\n    reject\n  };\n};\n\n// src/utils/logErrorInDevMode.ts\nvar logErrorInDevMode = message => {\n  if (isDevelopmentEnvironment()) {\n    console.error(`Clerk: ${message}`);\n  }\n};\n\n// src/utils/runWithExponentialBackOff.ts\nvar defaultOptions = {\n  firstDelay: 125,\n  maxDelay: 0,\n  timeMultiple: 2,\n  shouldRetry: () => true\n};\nvar sleep = async ms => new Promise(s => setTimeout(s, ms));\nvar createExponentialDelayAsyncFn = opts => {\n  let timesCalled = 0;\n  const calculateDelayInMs = () => {\n    const constant = opts.firstDelay;\n    const base = opts.timeMultiple;\n    const delay = constant * Math.pow(base, timesCalled);\n    return Math.min(opts.maxDelay || delay, delay);\n  };\n  return async () => {\n    await sleep(calculateDelayInMs());\n    timesCalled++;\n  };\n};\nvar runWithExponentialBackOff = async (callback, options = {}) => {\n  let iterationsCount = 0;\n  const {\n    shouldRetry,\n    firstDelay,\n    maxDelay,\n    timeMultiple\n  } = {\n    ...defaultOptions,\n    ...options\n  };\n  const delay = createExponentialDelayAsyncFn({\n    firstDelay,\n    maxDelay,\n    timeMultiple\n  });\n  while (true) {\n    try {\n      return await callback();\n    } catch (e) {\n      iterationsCount++;\n      if (!shouldRetry(e, iterationsCount)) {\n        throw e;\n      }\n      await delay();\n    }\n  }\n};\n\n// src/loadScript.ts\nvar NO_DOCUMENT_ERROR = \"loadScript cannot be called when document does not exist\";\nvar NO_SRC_ERROR = \"loadScript cannot be called without a src\";\nasync function loadScript(src = \"\", opts) {\n  const {\n    async,\n    defer,\n    beforeLoad,\n    crossOrigin,\n    nonce\n  } = opts || {};\n  const load = () => {\n    return new Promise((resolve, reject) => {\n      if (!src) {\n        reject(NO_SRC_ERROR);\n      }\n      if (!document || !document.body) {\n        reject(NO_DOCUMENT_ERROR);\n      }\n      const script = document.createElement(\"script\");\n      crossOrigin && script.setAttribute(\"crossorigin\", crossOrigin);\n      script.async = async || false;\n      script.defer = defer || false;\n      script.addEventListener(\"load\", () => {\n        script.remove();\n        resolve(script);\n      });\n      script.addEventListener(\"error\", () => {\n        script.remove();\n        reject();\n      });\n      script.src = src;\n      script.nonce = nonce;\n      beforeLoad == null ? void 0 : beforeLoad(script);\n      document.body.appendChild(script);\n    });\n  };\n  return runWithExponentialBackOff(load, {\n    shouldRetry: (_, iterations) => iterations < 5\n  });\n}\nexport { createDeferredPromise, logErrorInDevMode, runWithExponentialBackOff, loadScript };","map":{"version":3,"names":["createDeferredPromise","resolve","noop","reject","promise","Promise","res","rej","logErrorInDevMode","message","isDevelopmentEnvironment","console","error","defaultOptions","firstDelay","maxDelay","timeMultiple","shouldRetry","sleep","ms","s","setTimeout","createExponentialDelayAsyncFn","opts","timesCalled","calculateDelayInMs","constant","base","delay","Math","pow","min","runWithExponentialBackOff","callback","options","iterationsCount","e","NO_DOCUMENT_ERROR","NO_SRC_ERROR","loadScript","src","async","defer","beforeLoad","crossOrigin","nonce","load","document","body","script","createElement","setAttribute","addEventListener","remove","appendChild","_","iterations"],"sources":["/Users/nethmeeperera/Desktop/my-app/node_modules/@clerk/shared/src/utils/createDeferredPromise.ts","/Users/nethmeeperera/Desktop/my-app/node_modules/@clerk/shared/src/utils/logErrorInDevMode.ts","/Users/nethmeeperera/Desktop/my-app/node_modules/@clerk/shared/src/utils/runWithExponentialBackOff.ts","/Users/nethmeeperera/Desktop/my-app/node_modules/@clerk/shared/src/loadScript.ts"],"sourcesContent":["import { noop } from './noop';\n\ntype Callback = (val?: any) => void;\n\n/**\n * Create a promise that can be resolved or rejected from\n * outside the Promise constructor callback\n */\nexport const createDeferredPromise = () => {\n  let resolve: Callback = noop;\n  let reject: Callback = noop;\n  const promise = new Promise((res, rej) => {\n    resolve = res;\n    reject = rej;\n  });\n  return { promise, resolve, reject };\n};\n","import { isDevelopmentEnvironment } from './runtimeEnvironment';\n\nexport const logErrorInDevMode = (message: string) => {\n  if (isDevelopmentEnvironment()) {\n    console.error(`Clerk: ${message}`);\n  }\n};\n","type Milliseconds = number;\n\ntype BackoffOptions = Partial<{\n  firstDelay: Milliseconds;\n  maxDelay: Milliseconds;\n  timeMultiple: number;\n  shouldRetry: (error: unknown, iterationsCount: number) => boolean;\n}>;\n\nconst defaultOptions: Required<BackoffOptions> = {\n  firstDelay: 125,\n  maxDelay: 0,\n  timeMultiple: 2,\n  shouldRetry: () => true,\n};\n\nconst sleep = async (ms: Milliseconds) => new Promise(s => setTimeout(s, ms));\n\nconst createExponentialDelayAsyncFn = (opts: {\n  firstDelay: Milliseconds;\n  maxDelay: Milliseconds;\n  timeMultiple: number;\n}) => {\n  let timesCalled = 0;\n\n  const calculateDelayInMs = () => {\n    const constant = opts.firstDelay;\n    const base = opts.timeMultiple;\n    const delay = constant * Math.pow(base, timesCalled);\n    return Math.min(opts.maxDelay || delay, delay);\n  };\n\n  return async (): Promise<void> => {\n    await sleep(calculateDelayInMs());\n    timesCalled++;\n  };\n};\n\nexport const runWithExponentialBackOff = async <T>(\n  callback: () => T | Promise<T>,\n  options: BackoffOptions = {},\n): Promise<T> => {\n  let iterationsCount = 0;\n  const { shouldRetry, firstDelay, maxDelay, timeMultiple } = {\n    ...defaultOptions,\n    ...options,\n  };\n  const delay = createExponentialDelayAsyncFn({ firstDelay, maxDelay, timeMultiple });\n\n  // eslint-disable-next-line no-constant-condition\n  while (true) {\n    try {\n      return await callback();\n    } catch (e) {\n      iterationsCount++;\n      if (!shouldRetry(e, iterationsCount)) {\n        throw e;\n      }\n      await delay();\n    }\n  }\n};\n","import { runWithExponentialBackOff } from './utils';\n\nconst NO_DOCUMENT_ERROR = 'loadScript cannot be called when document does not exist';\nconst NO_SRC_ERROR = 'loadScript cannot be called without a src';\n\ntype LoadScriptOptions = {\n  async?: boolean;\n  defer?: boolean;\n  crossOrigin?: 'anonymous' | 'use-credentials';\n  nonce?: string;\n  beforeLoad?: (script: HTMLScriptElement) => void;\n};\n\nexport async function loadScript(src = '', opts: LoadScriptOptions): Promise<HTMLScriptElement> {\n  const { async, defer, beforeLoad, crossOrigin, nonce } = opts || {};\n\n  const load = () => {\n    return new Promise<HTMLScriptElement>((resolve, reject) => {\n      if (!src) {\n        reject(NO_SRC_ERROR);\n      }\n\n      if (!document || !document.body) {\n        reject(NO_DOCUMENT_ERROR);\n      }\n\n      const script = document.createElement('script');\n\n      crossOrigin && script.setAttribute('crossorigin', crossOrigin);\n      script.async = async || false;\n      script.defer = defer || false;\n\n      script.addEventListener('load', () => {\n        script.remove();\n        resolve(script);\n      });\n\n      script.addEventListener('error', () => {\n        script.remove();\n        reject();\n      });\n\n      script.src = src;\n      script.nonce = nonce;\n      beforeLoad?.(script);\n      document.body.appendChild(script);\n    });\n  };\n\n  return runWithExponentialBackOff(load, { shouldRetry: (_, iterations) => iterations < 5 });\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}