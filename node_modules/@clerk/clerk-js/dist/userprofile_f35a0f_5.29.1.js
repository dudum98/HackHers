"use strict";(globalThis.webpackChunk_clerk_clerk_js=globalThis.webpackChunk_clerk_clerk_js||[]).push([[45,644,263,882,501],{4994:function(e,o,t){t.r(o),t.d(o,{UserProfile:function(){return co},UserProfileModal:function(){return uo}});var r=t(4380),i=t(4041),n=t(844),s=t(9333),a=t(8369),l=t(166),c=t(9513);const d=e=>{const{pages:o}=(0,n.useUserProfileContext)();return(0,r.FD)(a.NavbarContextProvider,{children:[(0,r.Y)(a.NavBar,{title:(0,c.GQ)("userProfile.navbar.title"),description:(0,c.GQ)("userProfile.navbar.description"),routes:o.routes,contentRef:e.contentRef}),e.children]})};var u=t(9834),m=t(2237),h=t(3931),p=t(4870),f=t(7362),v=t(3090),g=t(2572),y=t(5909),P=t(4859),b=t(9927);const Y=()=>{const e=(0,a.useCardState)(),{user:o}=(0,h.Jd)(),{navigate:t}=(0,l.useRouter)(),{strategies:i,strategyToDisplayData:c}=(0,y.kF)(),{additionalOAuthScopes:d,componentName:u,mode:m}=(0,n.useUserProfileContext)(),{handleAssurance:v}=(0,P.r)(),g="modal"===m,Y=i.filter((e=>e.startsWith("oauth"))),S=null==o?void 0:o.verifiedExternalAccounts.map((e=>`oauth_${e.provider}`)),C=Y.filter((e=>!S.includes(e)));return 0===C.length?null:(0,r.Y)(a.ProfileSection.ActionMenu,{triggerLocalizationKey:(0,s.localizationKeys)("userProfile.start.connectedAccountsSection.primaryButton"),id:"connectedAccounts",children:C.map((i=>{const n=c[i].iconUrl?(0,r.Y)(s.Image,{isLoading:e.loadingMetadata===i,isDisabled:e.isLoading,elementDescriptor:s.descriptors.providerIcon,elementId:s.descriptors.providerIcon.setId(c[i].id),src:c[i].iconUrl,alt:`Connect ${c[i].name} account`,sx:e=>({width:e.sizes.$4})}):(0,r.Y)(f.Tr,{id:c[i].id,value:c[i].name,isLoading:e.loadingMetadata===i,isDisabled:e.isLoading});return(0,r.Y)(a.ProfileSection.ActionMenuItem,{id:c[i].id,onClick:()=>(r=>{if(!o)return;const i=r.replace("oauth_",""),n=g?(0,p.jk)({url:window.location.href,componentName:u,socialProvider:i}):window.location.href,s=d?d[i]:[];return e.setLoading(r),v((()=>o.createExternalAccount({strategy:r,redirectUrl:n,additionalScopes:s}))).then((o=>{var i;(null===(i=o.verification)||void 0===i?void 0:i.externalVerificationRedirectURL)&&((0,b.yy)(2e3).then((()=>e.setIdle(r))),t(o.verification.externalVerificationRedirectURL.href))})).catch((o=>{(0,b.H4)(o,[],e.setError),e.setIdle(r)}))})(i),isDisabled:e.isLoading,variant:"ghost",isLoading:e.loadingMetadata===i,focusRing:!1,closeAfterClick:!1,localizationKey:(0,s.localizationKeys)("userProfile.connectedAccountPage.socialButtonsBlockButton",{provider:c[i].name}),sx:e=>({justifyContent:"start",gap:e.space.$2}),leftIcon:n},i)}))})},S=e=>{var o;const{onSuccess:t,onReset:n}=e,{user:a}=(0,h.Jd)(),{emailId:l}=e,c=null==a?void 0:a.emailAddresses.find((e=>e.id===l)),d=i.useRef(null==c?void 0:c.emailAddress),u="verified"===(null===(o=null==c?void 0:c.verification)||void 0===o?void 0:o.status)?(0,s.localizationKeys)("userProfile.emailAddressPage.removeResource.messageLine2"):void 0;return d.current?(0,r.Y)(f.P_,{title:(0,s.localizationKeys)("userProfile.emailAddressPage.removeResource.title"),messageLine1:(0,s.localizationKeys)("userProfile.emailAddressPage.removeResource.messageLine1",{identifier:d.current}),messageLine2:u,successMessage:(0,s.localizationKeys)("userProfile.emailAddressPage.removeResource.successMessage",{emailAddress:d.current}),deleteResource:()=>Promise.resolve(null==c?void 0:c.destroy()),onSuccess:t,onReset:n}):null},C=e=>{var o;const{phoneId:t,onSuccess:n,onReset:a}=e,{user:l}=(0,h.Jd)(),c=null==l?void 0:l.phoneNumbers.find((e=>e.id===t)),d=i.useRef(null==c?void 0:c.phoneNumber),u="verified"===(null===(o=null==c?void 0:c.verification)||void 0===o?void 0:o.status)?(0,s.localizationKeys)("userProfile.phoneNumberPage.removeResource.messageLine2"):void 0;return d.current?(0,r.Y)(f.P_,{title:(0,s.localizationKeys)("userProfile.phoneNumberPage.removeResource.title"),messageLine1:(0,s.localizationKeys)("userProfile.phoneNumberPage.removeResource.messageLine1",{identifier:d.current}),messageLine2:u,successMessage:(0,s.localizationKeys)("userProfile.phoneNumberPage.removeResource.successMessage",{phoneNumber:d.current}),deleteResource:()=>Promise.resolve(null==c?void 0:c.destroy()),onSuccess:n,onReset:a}):null},z=e=>{var o,t;const{accountId:n,onSuccess:a,onReset:l}=e,{user:c}=(0,h.Jd)(),d=null==c?void 0:c.externalAccounts.find((e=>e.id===n)),u=i.useRef(null==d?void 0:d.provider),{providerToDisplayData:m}=(0,y.kF)();return u.current?(0,r.Y)(f.P_,{title:(0,s.localizationKeys)("userProfile.connectedAccountPage.removeResource.title"),messageLine1:(0,s.localizationKeys)("userProfile.connectedAccountPage.removeResource.messageLine1",{identifier:null===(o=m[u.current])||void 0===o?void 0:o.name}),messageLine2:(0,s.localizationKeys)("userProfile.connectedAccountPage.removeResource.messageLine2"),successMessage:(0,s.localizationKeys)("userProfile.connectedAccountPage.removeResource.successMessage",{connectedAccount:null===(t=m[u.current])||void 0===t?void 0:t.name}),deleteResource:()=>Promise.resolve(null==d?void 0:d.destroy()),onSuccess:a,onReset:l}):null},F=e=>{var o;const{user:t}=(0,h.Jd)(),{walletId:n,onSuccess:a,onReset:l}=e,c=null==t?void 0:t.web3Wallets.find((e=>e.id===n)),d=i.useRef(null==c?void 0:c.web3Wallet),u="verified"===(null===(o=null==c?void 0:c.verification)||void 0===o?void 0:o.status)?(0,s.localizationKeys)("userProfile.web3WalletPage.removeResource.messageLine2"):void 0;return d.current?(0,r.Y)(f.P_,{title:(0,s.localizationKeys)("userProfile.web3WalletPage.removeResource.title"),messageLine1:(0,s.localizationKeys)("userProfile.web3WalletPage.removeResource.messageLine1",{identifier:d.current}),messageLine2:u,successMessage:(0,s.localizationKeys)("userProfile.web3WalletPage.removeResource.successMessage",{web3Wallet:d.current}),deleteResource:()=>Promise.resolve(null==c?void 0:c.destroy()),onSuccess:a,onReset:l}):null},K=e=>{const{user:o}=(0,h.Jd)(),{phoneId:t,onSuccess:n,onReset:a}=e,l=null==o?void 0:o.phoneNumbers.find((e=>e.id===t)),c=i.useRef(null==l?void 0:l.phoneNumber);return c.current?(0,r.Y)(f.P_,{title:(0,s.localizationKeys)("userProfile.mfaPhoneCodePage.removeResource.title"),messageLine1:(0,s.localizationKeys)("userProfile.mfaPhoneCodePage.removeResource.messageLine1",{identifier:c.current}),messageLine2:(0,s.localizationKeys)("userProfile.mfaPhoneCodePage.removeResource.messageLine2"),successMessage:(0,s.localizationKeys)("userProfile.mfaPhoneCodePage.removeResource.successMessage",{mfaPhoneCode:c.current}),deleteResource:()=>Promise.resolve(null==l?void 0:l.setReservedForSecondFactor({reserved:!1})),onSuccess:n,onReset:a}):null},_=e=>{const{onSuccess:o,onReset:t}=e,{user:i}=(0,h.Jd)();return i?(0,r.Y)(f.P_,{title:(0,s.localizationKeys)("userProfile.mfaTOTPPage.removeResource.title"),messageLine1:(0,s.localizationKeys)("userProfile.mfaTOTPPage.removeResource.messageLine1"),messageLine2:(0,s.localizationKeys)("userProfile.mfaTOTPPage.removeResource.messageLine2"),successMessage:(0,s.localizationKeys)("userProfile.mfaTOTPPage.removeResource.successMessage"),deleteResource:i.disableTOTP,onSuccess:o,onReset:t}):null},R=e=>{const{onSuccess:o,onReset:t,passkey:i}=e;return(0,r.Y)(f.P_,{title:(0,s.localizationKeys)("userProfile.passkeyScreen.removeResource.title"),messageLine1:(0,s.localizationKeys)("userProfile.passkeyScreen.removeResource.messageLine1",{name:i.name}),deleteResource:i.delete,onSuccess:o,onReset:t})},x=e=>{const{close:o}=(0,g.D5)();return(0,r.Y)(z,{onSuccess:o,onReset:o,...e})},D=["external_account_missing_refresh_token","oauth_fetch_user_error","oauth_token_exchange_error","external_account_email_address_verification_required"],k=(0,a.withCardStateProvider)((({shouldAllowCreation:e=!0})=>{var o;const{user:t}=(0,h.Jd)(),i=(0,a.useCardState)(),n=Boolean(null===(o=null==t?void 0:t.externalAccounts)||void 0===o?void 0:o.length);if(!t||!e&&!n)return null;const l=[...t.verifiedExternalAccounts,...t.unverifiedExternalAccounts.filter((e=>{var o;return null===(o=e.verification)||void 0===o?void 0:o.error}))];return(0,r.FD)(a.ProfileSection.Root,{title:(0,s.localizationKeys)("userProfile.start.connectedAccountsSection.title"),centered:!1,id:"connectedAccounts",children:[(0,r.Y)(a.Card.Alert,{children:i.error}),(0,r.FD)(v.r.Root,{children:[(0,r.Y)(a.ProfileSection.ItemList,{id:"connectedAccounts",children:l.map((e=>(0,r.Y)(w,{account:e},e.id)))}),e&&(0,r.Y)(Y,{})]})]})})),w=({account:e})=>{var o,t,i,c,d,u;const{additionalOAuthScopes:m,componentName:g,mode:Y}=(0,n.useUserProfileContext)(),{navigate:S}=(0,l.useRouter)(),{user:C}=(0,h.Jd)(),z=(0,a.useCardState)(),{handleAssurance:F}=(0,P.r)();if(!C)return null;const K="modal"===Y,{providerToDisplayData:_}=(0,y.kF)(),R=e.username||e.emailAddress,k=null===(t=null===(o=e.verification)||void 0===o?void 0:o.error)||void 0===t?void 0:t.longMessage,w=function(e,o){if(!o)return[];const t=o[e.provider]||[],r=e.approvedScopes.split(" ");return 0===t.filter((e=>!r.includes(e))).length?[]:t}(e,m),A=w.length>0&&""!=e.approvedScopes,I=D.includes((null===(c=null===(i=e.verification)||void 0===i?void 0:i.error)||void 0===c?void 0:c.code)||"")||A,B=I?(0,s.localizationKeys)("userProfile.start.connectedAccountsSection.subtitle__disconnected"):k;return(0,r.FD)(v.r.Root,{children:[(0,r.FD)(a.ProfileSection.Item,{id:"connectedAccounts",children:[(0,r.FD)(s.Flex,{sx:e=>({overflow:"hidden",gap:e.space.$2}),children:[(0,r.Y)((()=>_[e.provider].iconUrl?(0,r.Y)(s.Image,{elementDescriptor:[s.descriptors.providerIcon],elementId:s.descriptors.socialButtonsProviderIcon.setId(e.provider),alt:_[e.provider].name,src:_[e.provider].iconUrl,sx:e=>({width:e.sizes.$4,flexShrink:0})}):(0,r.Y)(f.Tr,{id:e.provider,value:_[e.provider].name})),{}),(0,r.Y)(s.Box,{sx:{whiteSpace:"nowrap",overflow:"hidden"},children:(0,r.FD)(s.Flex,{gap:2,center:!0,children:[(0,r.Y)(s.Text,{sx:e=>({color:e.colors.$colorText}),children:`${_[e.provider].name}`}),(0,r.Y)(s.Text,{truncate:!0,as:"span",colorScheme:"secondary",children:R?`• ${R}`:""})]})})]}),(0,r.Y)(T,{})]}),I&&(0,r.FD)(s.Box,{sx:e=>({padding:`${e.sizes.$none} ${e.sizes.$none} ${e.sizes.$1x5} ${e.sizes.$8x5}`}),children:[(0,r.Y)(s.Text,{colorScheme:"secondary",sx:e=>({paddingRight:e.sizes.$1x5,display:"inline-block"}),localizationKey:B}),(0,r.Y)(s.Button,{sx:{display:"inline-block"},onClick:async()=>{var o;const t=K?(0,p.jk)({url:window.location.href,componentName:g}):window.location.href;try{let r;r=A?await e.reauthorize({additionalScopes:w,redirectUrl:t}):await F((()=>C.createExternalAccount({strategy:e.verification.strategy,redirectUrl:t,additionalScopes:w}))),await S((null===(o=r.verification.externalVerificationRedirectURL)||void 0===o?void 0:o.href)||"")}catch(r){(0,b.H4)(r,[],z.setError)}},variant:"link",localizationKey:(0,s.localizationKeys)("userProfile.start.connectedAccountsSection.actionLabel__connectionFailed")})]}),(null===(u=null===(d=e.verification)||void 0===d?void 0:d.error)||void 0===u?void 0:u.code)&&!I&&(0,r.Y)(s.Text,{colorScheme:"danger",sx:e=>({padding:`${e.sizes.$none} ${e.sizes.$1x5} ${e.sizes.$1x5} ${e.sizes.$8x5}`}),children:k}),(0,r.Y)(v.r.Open,{value:"remove",children:(0,r.Y)(v.r.Card,{variant:"destructive",children:(0,r.Y)(x,{accountId:e.id})})})]},e.id)},T=()=>{const{open:e}=(0,g.D5)(),o=[{label:(0,s.localizationKeys)("userProfile.start.connectedAccountsSection.destructiveActionTitle"),isDestructive:!0,onClick:()=>e("remove")}].filter((e=>null!==e));return(0,r.Y)(a.ThreeDotsMenu,{actions:o})},A=e=>e.defaultSecondFactor?-1:1;function I(e){const o=[];return Object.entries(e).forEach((([,e])=>{e.used_for_second_factor&&o.push(...e.second_factors)})),o}function B(e,o){let t=I(e);return o.totpEnabled&&(t=t.filter((e=>"totp"!==e))),!o.backupCodeEnabled&&o.twoFactorEnabled||(t=t.filter((e=>"backup_code"!==e))),t}function L(e,o){if(!e)return[];const t=e.filter((e=>e.id===o)),r=e.filter((e=>e.id!==o)),i=r.filter((e=>{var o;return"verified"===(null===(o=e.verification)||void 0===o?void 0:o.status)})),n=r.filter((e=>{var o,t;return!!(null===(o=e.verification)||void 0===o?void 0:o.status)&&"verified"!==(null===(t=e.verification)||void 0===t?void 0:t.status)})),s=r.filter((e=>!e.verification.status));return i.sort(((e,o)=>e.id.localeCompare(o.id))),n.sort(((e,o)=>{var t,r;return(null===(t=e.verification)||void 0===t?void 0:t.expireAt)&&(null===(r=o.verification)||void 0===r?void 0:r.expireAt)?e.verification.expireAt.getTime()-o.verification.expireAt.getTime():0})),[...t,...i,...n,...s]}const $=e=>{const o=(0,a.useCardState)(),{nextStep:t,identification:n,identifier:l,onReset:c,prepareVerification:d}=e,u=()=>{var e;return null===(e=null==d?void 0:d())||void 0===e?void 0:e.catch((e=>(0,b.H4)(e,[],o.setError)))},m=(0,a.useFieldOTP)({onCodeEntryFinished:(e,o,t)=>{null==n||n.attemptVerification({code:e}).then((()=>o())).catch(t)},onResendCodeClicked:u,onResolve:t});return i.useEffect((()=>{u()}),[]),(0,r.FD)(r.FK,{children:[(0,r.Y)(a.Form.OTPInput,{...m,label:(0,s.localizationKeys)("userProfile.emailAddressPage.emailCode.formTitle"),description:(0,s.localizationKeys)("userProfile.emailAddressPage.emailCode.formSubtitle",{identifier:l}),resendButton:(0,s.localizationKeys)("userProfile.emailAddressPage.emailCode.resendButton"),centerAlign:!1}),(0,r.FD)(a.FormButtonContainer,{children:[(0,r.Y)(s.Button,{isLoading:m.isLoading,localizationKey:(0,s.localizationKeys)("formButtonPrimary__verify"),elementDescriptor:s.descriptors.formButtonPrimary,onClick:m.onFakeContinue}),(0,r.Y)(s.Button,{variant:"ghost",isDisabled:m.isLoading,localizationKey:(0,s.localizationKeys)("userProfile.formButtonReset"),elementDescriptor:s.descriptors.formButtonReset,onClick:c})]})]})};var E=t(7453);const N=e=>{const{email:o,nextStep:t,onReset:l}=e,c=(0,a.useCardState)(),d=(0,n.useUserProfileContext)(),{startEmailLinkFlow:u}=(0,y.ui)(o),{displayConfig:m}=(0,n.useEnvironment)();function h(){const{routing:e}=d,o="virtual"===e?m.userProfileUrl:"",r=(0,E.W)(d,o);u({redirectUrl:r}).then((()=>t())).catch((e=>(0,b.H4)(e,[],c.setError)))}return i.useEffect((()=>{h()}),[]),(0,r.FD)(r.FK,{children:[(0,r.Y)(a.VerificationLink,{resendButton:(0,s.localizationKeys)("userProfile.emailAddressPage.emailLink.resendButton"),onResendCodeClicked:h}),(0,r.Y)(a.FormButtonContainer,{children:(0,r.Y)(s.Button,{variant:"ghost",localizationKey:(0,s.localizationKeys)("userProfile.formButtonReset"),elementDescriptor:s.descriptors.formButtonReset,onClick:l})})]})},U=()=>(0,r.Y)(f.$W,{title:(0,s.localizationKeys)("signUp.emailLink.verifiedSwitchTab.title"),subtitle:(0,s.localizationKeys)("signUp.emailLink.verifiedSwitchTab.subtitle"),status:"verified"}),O=(0,a.withCardStateProvider)((e=>{var o,t,l;const{emailId:c,onSuccess:d,onReset:u}=e,m=(0,a.useCardState)(),{user:p}=(0,h.Jd)(),{handleAssurance:v}=(0,P.r)(),g=function(e){const{userSettings:o}=e,{email_address:t}=o.attributes;return t.enabled&&t.verifications.includes("email_link")}((0,n.useEnvironment)()),y=i.useRef(null==p?void 0:p.emailAddresses.find((e=>e.id===c))),Y=(0,f.Xi)({defaultStep:y.current?1:0,onNextStep:()=>m.setError(void 0)}),S=(0,b.tJ)("emailAddress","",{type:"email",label:(0,s.localizationKeys)("formFieldLabel__emailAddress"),placeholder:(0,s.localizationKeys)("formFieldInputPlaceholder__emailAddress"),isRequired:!0}),C=S.value.length>1&&(null==p?void 0:p.username)!==S.value;return(0,r.FD)(f.sQ,{...Y.props,children:[(0,r.Y)(a.FormContainer,{headerTitle:(0,s.localizationKeys)("userProfile.emailAddressPage.title"),headerSubtitle:g?(0,s.localizationKeys)("userProfile.emailAddressPage.emailLink.formHint"):(0,s.localizationKeys)("userProfile.emailAddressPage.emailCode.formHint"),children:(0,r.FD)(a.Form.Root,{onSubmit:async e=>{if(e.preventDefault(),p)return v((()=>p.createEmailAddress({email:S.value}))).then((e=>{y.current=e,Y.nextStep()})).catch((e=>(0,b.H4)(e,[S],m.setError)))},children:[(0,r.Y)(a.Form.ControlRow,{elementId:S.id,children:(0,r.Y)(a.Form.PlainInput,{...S.props,autoFocus:!0})}),(0,r.Y)(a.FormButtons,{submitLabel:(0,s.localizationKeys)("userProfile.formButtonPrimary__add"),isDisabled:!C,onReset:u})]})}),(0,r.Y)(a.FormContainer,{headerTitle:(0,s.localizationKeys)("userProfile.emailAddressPage.verifyTitle"),headerSubtitle:g?(0,s.localizationKeys)("userProfile.emailAddressPage.emailLink.formSubtitle",{identifier:null===(o=y.current)||void 0===o?void 0:o.emailAddress}):(0,s.localizationKeys)("userProfile.emailAddressPage.emailCode.formSubtitle",{identifier:null===(t=y.current)||void 0===t?void 0:t.emailAddress}),children:g?(0,r.Y)(N,{nextStep:d,email:y.current,onReset:u}):(0,r.Y)($,{nextStep:d,identification:y.current,identifier:null===(l=y.current)||void 0===l?void 0:l.emailAddress,prepareVerification:()=>{var e;return null===(e=y.current)||void 0===e?void 0:e.prepareVerification({strategy:"email_code"})},onReset:u})})]})})),M=e=>{const{close:o}=(0,g.D5)();return(0,r.Y)(S,{onSuccess:o,onReset:o,...e})},J=e=>{const{close:o}=(0,g.D5)();return(0,r.Y)(O,{onSuccess:o,onReset:o,...e})},W=({shouldAllowCreation:e=!0})=>{const{user:o}=(0,h.Jd)();return(0,r.Y)(a.ProfileSection.Root,{title:(0,s.localizationKeys)("userProfile.start.emailAddressesSection.title"),centered:!1,id:"emailAddresses",children:(0,r.Y)(v.r.Root,{children:(0,r.FD)(a.ProfileSection.ItemList,{id:"emailAddresses",children:[L(null==o?void 0:o.emailAddresses,null==o?void 0:o.primaryEmailAddressId).map((e=>(0,r.FD)(v.r.Root,{children:[(0,r.FD)(a.ProfileSection.Item,{id:"emailAddresses",children:[(0,r.FD)(s.Flex,{sx:e=>({overflow:"hidden",gap:e.space.$1}),children:[(0,r.Y)(s.Text,{sx:e=>({color:e.colors.$colorText}),truncate:!0,children:e.emailAddress}),(null==o?void 0:o.primaryEmailAddressId)===e.id&&(0,r.Y)(s.Badge,{localizationKey:(0,s.localizationKeys)("badge__primary")}),"verified"!==e.verification.status&&(0,r.Y)(s.Badge,{localizationKey:(0,s.localizationKeys)("badge__unverified")})]}),(0,r.Y)(H,{email:e})]}),(0,r.Y)(v.r.Open,{value:"remove",children:(0,r.Y)(v.r.Card,{variant:"destructive",children:(0,r.Y)(M,{emailId:e.id})})}),(0,r.Y)(v.r.Open,{value:"verify",children:(0,r.Y)(v.r.Card,{children:(0,r.Y)(J,{emailId:e.id})})})]},e.emailAddress))),e&&(0,r.FD)(r.FK,{children:[(0,r.Y)(v.r.Trigger,{value:"add",children:(0,r.Y)(a.ProfileSection.ArrowButton,{id:"emailAddresses",localizationKey:(0,s.localizationKeys)("userProfile.start.emailAddressesSection.primaryButton")})}),(0,r.Y)(v.r.Open,{value:"add",children:(0,r.Y)(v.r.Card,{children:(0,r.Y)(J,{})})})]})]})})})},H=({email:e})=>{const o=(0,a.useCardState)(),{user:t}=(0,h.Jd)(),{open:i}=(0,g.D5)(),n=(null==t?void 0:t.primaryEmailAddressId)===e.id,l="verified"===e.verification.status,c=[n&&!l?{label:(0,s.localizationKeys)("userProfile.start.emailAddressesSection.detailsAction__primary"),onClick:()=>i("verify")}:null,!n&&l?{label:(0,s.localizationKeys)("userProfile.start.emailAddressesSection.detailsAction__nonPrimary"),onClick:()=>null==t?void 0:t.update({primaryEmailAddressId:e.id}).catch((e=>(0,b.H4)(e,[],o.setError)))}:null,n||l?null:{label:(0,s.localizationKeys)("userProfile.start.emailAddressesSection.detailsAction__unverified"),onClick:()=>i("verify")},{label:(0,s.localizationKeys)("userProfile.start.emailAddressesSection.destructiveAction"),isDestructive:!0,onClick:()=>i("remove")}].filter((e=>null!==e));return(0,r.Y)(a.ThreeDotsMenu,{actions:c})},q=()=>{const{user:e}=(0,h.Jd)(),{getSamlProviderLogoUrl:o,getSamlProviderName:t}=(0,y.jn)();return(0,r.Y)(a.ProfileSection.Root,{title:(0,s.localizationKeys)("userProfile.start.enterpriseAccountsSection.title"),id:"enterpriseAccounts",centered:!1,children:(0,r.Y)(a.ProfileSection.ItemList,{id:"enterpriseAccounts",children:null==e?void 0:e.samlAccounts.map((e=>{var i,n;const l=e.emailAddress,c=t(e.provider),d=o(e.provider),u=null===(n=null===(i=e.verification)||void 0===i?void 0:i.error)||void 0===n?void 0:n.longMessage;return(0,r.FD)(a.ProfileSection.Item,{id:"enterpriseAccounts",sx:e=>({gap:e.space.$2,justifyContent:"start"}),children:[(0,r.Y)(s.Image,{elementDescriptor:[s.descriptors.providerIcon],elementId:s.descriptors.enterpriseButtonsProviderIcon.setId(e.provider),alt:c,src:d,sx:e=>({width:e.sizes.$4})}),(0,r.Y)(s.Box,{sx:{whiteSpace:"nowrap",overflow:"hidden"},children:(0,r.FD)(s.Flex,{gap:2,center:!0,children:[(0,r.Y)(s.Text,{truncate:!0,colorScheme:"body",children:c}),(0,r.Y)(s.Text,{truncate:!0,as:"span",colorScheme:"secondary",children:l?`• ${l}`:""}),u&&(0,r.Y)(s.Badge,{colorScheme:"danger",localizationKey:(0,s.localizationKeys)("badge__requiresAction")})]})})]},e.id)}))})})},V=(0,a.withCardStateProvider)((e=>{const{phoneId:o,onSuccess:t,onReset:n}=e,{user:a}=(0,h.Jd)(),l=i.useRef(null==a?void 0:a.phoneNumbers.find((e=>e.id===o))),c=(0,f.Xi)({defaultStep:l.current?1:0});return(0,r.FD)(f.sQ,{...c.props,children:[(0,r.Y)(j,{resourceRef:l,title:(0,s.localizationKeys)("userProfile.phoneNumberPage.title"),onSuccess:c.nextStep,onReset:n}),(0,r.Y)(G,{resourceRef:l,title:(0,s.localizationKeys)("userProfile.phoneNumberPage.verifyTitle"),onSuccess:t,onReset:n})]})})),j=e=>{var o;const{title:t,onSuccess:i,onReset:n,onUseExistingNumberClick:l,resourceRef:c}=e,d=(0,a.useCardState)(),{user:u}=(0,h.Jd)(),{handleAssurance:m}=(0,P.r)(),p=(0,b.tJ)("phoneNumber","",{type:"tel",label:(0,s.localizationKeys)("formFieldLabel__phoneNumber"),isRequired:!0}),f=p.value.length>1&&(null==u?void 0:u.username)!==p.value,v=!!(null===(o=null==u?void 0:u.phoneNumbers)||void 0===o?void 0:o.length)&&l;return(0,r.Y)(a.FormContainer,{headerTitle:t,gap:1,children:(0,r.FD)(a.Form.Root,{gap:4,onSubmit:async e=>{if(e.preventDefault(),u)return m((()=>u.createPhoneNumber({phoneNumber:p.value}))).then((e=>{c.current=e,i()})).catch((e=>(0,b.H4)(e,[p],d.setError)))},children:[(0,r.Y)(s.Text,{localizationKey:(0,s.localizationKeys)("userProfile.phoneNumberPage.infoText"),colorScheme:"secondary"}),(0,r.Y)(a.Form.ControlRow,{elementId:p.id,children:(0,r.Y)(a.Form.PhoneInput,{...p.props,autoFocus:!0})}),(0,r.FD)(s.Flex,{justify:v?"between":"end",children:[v&&(0,r.Y)(s.Button,{variant:"ghost",localizationKey:(0,s.localizationKeys)("userProfile.mfaPhoneCodePage.backButton"),onClick:l}),(0,r.Y)(a.FormButtons,{submitLabel:(0,s.localizationKeys)("userProfile.formButtonPrimary__add"),isDisabled:!f,onReset:n})]})]})})},G=e=>{var o,t,i;const{title:n,onSuccess:l,resourceRef:c,onReset:d}=e;return(0,r.Y)(a.FormContainer,{headerTitle:n,headerSubtitle:(0,s.localizationKeys)("userProfile.phoneNumberPage.verifySubtitle",{identifier:null===(o=c.current)||void 0===o?void 0:o.phoneNumber}),children:(0,r.Y)($,{nextStep:l,identification:c.current,identifier:null===(t=c.current)||void 0===t?void 0:t.phoneNumber,prepareVerification:null===(i=c.current)||void 0===i?void 0:i.prepareVerification,onReset:d})})},Q=e=>{const{close:o}=(0,g.D5)();return(0,r.Y)(C,{onSuccess:o,onReset:o,...e})},X=e=>{const{close:o}=(0,g.D5)();return(0,r.Y)(V,{onSuccess:o,onReset:o,...e})},Z=({shouldAllowCreation:e=!0})=>{var o;const{user:t}=(0,h.Jd)(),i=Boolean(null===(o=null==t?void 0:t.phoneNumbers)||void 0===o?void 0:o.length);return e||i?(0,r.Y)(a.ProfileSection.Root,{centered:!1,title:(0,s.localizationKeys)("userProfile.start.phoneNumbersSection.title"),id:"phoneNumbers",children:(0,r.Y)(v.r.Root,{children:(0,r.FD)(a.ProfileSection.ItemList,{id:"phoneNumbers",children:[L(null==t?void 0:t.phoneNumbers,null==t?void 0:t.primaryPhoneNumberId).map((e=>(0,r.FD)(v.r.Root,{children:[(0,r.Y)(v.r.Closed,{value:"",children:(0,r.FD)(a.ProfileSection.Item,{id:"phoneNumbers",children:[(0,r.Y)(s.Box,{sx:{whiteSpace:"nowrap",overflow:"hidden"},children:(0,r.FD)(s.Flex,{gap:2,center:!0,children:[(0,r.Y)(s.Text,{sx:e=>({color:e.colors.$colorText}),children:(0,b.Om)(e.phoneNumber)}),(null==t?void 0:t.primaryPhoneNumberId)===e.id&&(0,r.Y)(s.Badge,{localizationKey:(0,s.localizationKeys)("badge__primary")}),"verified"!==e.verification.status&&(0,r.Y)(s.Badge,{localizationKey:(0,s.localizationKeys)("badge__unverified")})]})}),(0,r.Y)(ee,{phone:e})]})}),(0,r.Y)(v.r.Open,{value:"remove",children:(0,r.Y)(v.r.Card,{variant:"destructive",children:(0,r.Y)(Q,{phoneId:e.id})})}),(0,r.Y)(v.r.Open,{value:"verify",children:(0,r.Y)(v.r.Card,{children:(0,r.Y)(X,{phoneId:e.id})})})]},e.id))),e&&(0,r.FD)(r.FK,{children:[(0,r.Y)(v.r.Trigger,{value:"add",children:(0,r.Y)(a.ProfileSection.ArrowButton,{id:"phoneNumbers",localizationKey:(0,s.localizationKeys)("userProfile.start.phoneNumbersSection.primaryButton")})}),(0,r.Y)(v.r.Open,{value:"add",children:(0,r.Y)(v.r.Card,{children:(0,r.Y)(X,{})})})]})]})})}):null},ee=({phone:e})=>{const o=(0,a.useCardState)(),{open:t}=(0,g.D5)(),{user:i}=(0,h.Jd)();if(!i)return null;const n=i.primaryPhoneNumberId===e.id,l="verified"===e.verification.status,c=[n&&!l?{label:(0,s.localizationKeys)("userProfile.start.phoneNumbersSection.detailsAction__primary"),onClick:()=>t("verify")}:null,!n&&l?{label:(0,s.localizationKeys)("userProfile.start.phoneNumbersSection.detailsAction__nonPrimary"),onClick:()=>i.update({primaryPhoneNumberId:e.id}).catch((e=>(0,b.H4)(e,[],o.setError)))}:null,n||l?null:{label:(0,s.localizationKeys)("userProfile.start.phoneNumbersSection.detailsAction__unverified"),onClick:()=>t("verify")},{label:(0,s.localizationKeys)("userProfile.start.phoneNumbersSection.destructiveAction"),isDestructive:!0,onClick:()=>t("remove")}].filter((e=>null!==e));return(0,r.Y)(a.ThreeDotsMenu,{actions:c})};var oe=t(3965);const te=(0,a.withCardStateProvider)((e=>{const{onSuccess:o,onReset:t}=e,{handleAssurance:i}=(0,P.r)(),{user:l}=(0,h.Jd)();if(!l)return null;const{userSettings:c}=(0,n.useEnvironment)(),d=(0,a.useCardState)(),u=(0,b.tJ)("username",l.username||"",{type:"text",label:(0,s.localizationKeys)("formFieldLabel__username"),placeholder:(0,s.localizationKeys)("formFieldInputPlaceholder__username")}),m=c.attributes.username.required,p=(!m||u.value.length>0)&&l.username!==u.value;return(0,r.Y)(a.FormContainer,{headerTitle:l.username?(0,s.localizationKeys)("userProfile.usernamePage.title__update"):(0,s.localizationKeys)("userProfile.usernamePage.title__set"),children:(0,r.FD)(a.Form.Root,{onSubmit:async()=>{try{await i((()=>l.update({username:u.value}))),o()}catch(e){(0,b.H4)(e,[u],d.setError)}},children:[(0,r.Y)(a.Form.ControlRow,{elementId:u.id,children:(0,r.Y)(a.Form.PlainInput,{...u.props,autoFocus:!0,isRequired:m})}),(0,r.Y)(a.FormButtons,{isDisabled:!p,onReset:t})]})})})),re=()=>{const{close:e}=(0,g.D5)();return(0,r.Y)(te,{onSuccess:e,onReset:e})},ie=()=>{const{user:e}=(0,h.Jd)();return e?(0,r.Y)(a.ProfileSection.Root,{title:(0,s.localizationKeys)("userProfile.start.usernameSection.title"),id:"username",sx:{alignItems:"center",[oe.mqu.md]:{alignItems:"flex-start"}},children:(0,r.FD)(v.r.Root,{children:[(0,r.Y)(v.r.Closed,{value:"edit",children:(0,r.FD)(a.ProfileSection.Item,{id:"username",sx:{paddingLeft:e.username?void 0:"0"},children:[e.username&&(0,r.Y)(s.Text,{truncate:!0,sx:e=>({color:e.colors.$colorText}),children:e.username}),(0,r.Y)(v.r.Trigger,{value:"edit",children:(0,r.Y)(a.ProfileSection.Button,{id:"username",localizationKey:e.username?(0,s.localizationKeys)("userProfile.start.usernameSection.primaryButton__updateUsername"):(0,s.localizationKeys)("userProfile.start.usernameSection.primaryButton__setUsername")})})]})}),(0,r.Y)(v.r.Open,{value:"edit",children:(0,r.Y)(v.r.Card,{children:(0,r.Y)(re,{})})})]})}):null},ne=e=>{const{user:o,...t}=e;return(0,r.Y)(a.AvatarUploader,{...t,title:(0,c.GQ)("userProfile.profilePage.imageFormTitle"),avatarPreview:(0,r.Y)(a.UserAvatar,{size:e=>e.sizes.$12,...o})})},se=(0,a.withCardStateProvider)((e=>{const{onSuccess:o,onReset:t}=e,i=(0,a.useCardState)(),{user:l}=(0,h.Jd)();if(!l)return null;const{first_name:c,last_name:d}=(0,n.useEnvironment)().userSettings.attributes,u=c.enabled,m=d.enabled,f=l.firstName||"",v=l.lastName||"",g=(0,b.tJ)("firstName",l.firstName||"",{type:"text",label:(0,s.localizationKeys)("formFieldLabel__firstName"),placeholder:(0,s.localizationKeys)("formFieldInputPlaceholder__firstName"),isRequired:d.required}),y=(0,b.tJ)("lastName",l.lastName||"",{type:"text",label:(0,s.localizationKeys)("formFieldLabel__lastName"),placeholder:(0,s.localizationKeys)("formFieldInputPlaceholder__lastName"),isRequired:d.required}),P=u&&g.value!==f||m&&y.value!==v,Y=P,S=u&&c.required||m&&d.required,C=S&&!!y.value&&!!g.value&&Y,z=l.samlAccounts.some((e=>e.active));return(0,r.FD)(a.FormContainer,{headerTitle:(0,s.localizationKeys)("userProfile.profilePage.title"),children:[z&&(0,r.Y)(a.InformationBox,{message:(0,s.localizationKeys)("userProfile.profilePage.readonly")}),(0,r.FD)(a.Form.Root,{onSubmit:async e=>(e.preventDefault(),(P?l.update({firstName:g.value,lastName:y.value}):Promise.resolve()).then(o).catch((e=>{(0,b.H4)(e,[g,y],i.setError)}))),sx:e=>({gap:e.space.$6}),children:[(0,r.Y)(ne,{user:l,onAvatarChange:e=>l.setProfileImage({file:e}).then((()=>{i.setIdle()})).catch((e=>(0,b.H4)(e,[],i.setError))),onAvatarRemove:(0,p.px)(l.imageUrl)?null:()=>{l.setProfileImage({file:null}).then((()=>{i.setIdle()})).catch((e=>(0,b.H4)(e,[],i.setError)))}}),(u||m)&&(0,r.FD)(a.Form.ControlRow,{elementId:"name",children:[u&&(0,r.Y)(a.Form.PlainInput,{...g.props,isDisabled:z,autoFocus:!0}),m&&(0,r.Y)(a.Form.PlainInput,{...y.props,isDisabled:z,autoFocus:!u})]}),(0,r.Y)(a.FormButtons,{isDisabled:S?!C:!Y,onReset:t})]})]})})),ae=()=>{const{close:e}=(0,g.D5)();return(0,r.Y)(se,{onSuccess:e,onReset:e})},le=()=>{const{user:e}=(0,h.Jd)();if(!e)return null;const{username:o,primaryEmailAddress:t,primaryPhoneNumber:i,...n}=e;return(0,r.Y)(a.ProfileSection.Root,{title:(0,s.localizationKeys)("userProfile.start.profileSection.title"),id:"profile",sx:{[oe.mqu.md]:{alignItems:"flex-start"}},children:(0,r.FD)(v.r.Root,{children:[(0,r.Y)(v.r.Closed,{value:"edit",children:(0,r.FD)(a.ProfileSection.Item,{id:"profile",children:[(0,r.Y)(a.UserPreview,{user:n,size:"lg",mainIdentifierVariant:"subtitle",sx:e=>({color:e.colors.$colorText})}),(0,r.Y)(v.r.Trigger,{value:"edit",children:(0,r.Y)(a.ProfileSection.Button,{id:"profile",localizationKey:(0,s.localizationKeys)("userProfile.start.profileSection.primaryButton")})})]})}),(0,r.Y)(v.r.Open,{value:"edit",children:(0,r.Y)(v.r.Card,{children:(0,r.Y)(ae,{})})})]})})};var ce=t(7199);const de=(0,a.withCardStateProvider)((()=>{const e=(0,a.useCardState)(),{user:o}=(0,h.Jd)(),{strategies:t,strategyToDisplayData:i}=(0,y.kF)(),n=t.filter((e=>e.startsWith("web3"))),l=null==o?void 0:o.verifiedWeb3Wallets.map((e=>e.verification.strategy)),c=n.filter((e=>!l.includes(e)));return 0===c.length?null:(0,r.FD)(r.FK,{children:[(0,r.Y)(a.ProfileSection.ActionMenu,{id:"web3Wallets",triggerLocalizationKey:(0,s.localizationKeys)("userProfile.start.web3WalletsSection.primaryButton"),children:c.map((t=>(0,r.Y)(a.ProfileSection.ActionMenuItem,{id:i[t].id,onClick:()=>(async t=>{const r=t.replace("web3_","").replace("_signature","");e.setError(void 0);try{e.setLoading(t);const i=await(0,ce.hz)({provider:r});if(!o)throw new Error("user is not defined");let n=await o.createWeb3Wallet({web3Wallet:i});n=await n.prepareVerification({strategy:t});const s=n.verification.message,a=await(0,ce.$t)({identifier:i,nonce:s,provider:r});await n.attemptVerification({signature:a}),e.setIdle()}catch(i){e.setIdle();const o=(0,b.hG)(i);o?e.setError(o.longMessage):(0,b.H4)(i,[],e.setError)}})(t),isLoading:e.loadingMetadata===t,isDisabled:e.isLoading,localizationKey:(0,s.localizationKeys)("userProfile.web3WalletPage.web3WalletButtonsBlockButton",{provider:i[t].name}),sx:e=>({justifyContent:"start",gap:e.space.$2}),leftIcon:(0,r.Y)(s.Image,{elementDescriptor:s.descriptors.providerIcon,elementId:s.descriptors.providerIcon.setId(i[t].id),isLoading:e.loadingMetadata===t,isDisabled:e.isLoading,src:i[t].iconUrl,alt:`Connect ${i[t].name}`,sx:e=>({width:e.sizes.$5})})},t)))}),e.error&&(0,r.Y)(s.Text,{colorScheme:"danger",sx:e=>({padding:e.sizes.$1x5,paddingLeft:e.sizes.$8x5}),children:e.error})]})})),ue=e=>{const{close:o}=(0,g.D5)();return(0,r.Y)(F,{onSuccess:o,onReset:o,...e})},me=(0,a.withCardStateProvider)((({shouldAllowCreation:e=!0})=>{var o;const{user:t}=(0,h.Jd)(),i=(0,a.useCardState)(),{strategyToDisplayData:n}=(0,y.kF)(),l=Boolean(null===(o=null==t?void 0:t.web3Wallets)||void 0===o?void 0:o.length);return e||l?(0,r.FD)(a.ProfileSection.Root,{title:(0,s.localizationKeys)("userProfile.start.web3WalletsSection.title"),id:"web3Wallets",children:[(0,r.Y)(a.Card.Alert,{children:i.error}),(0,r.FD)(v.r.Root,{children:[(0,r.Y)(a.ProfileSection.ItemList,{id:"web3Wallets",children:null==t?void 0:t.web3Wallets.map((e=>{const o=e.verification.strategy;return n[o]&&(0,r.FD)(v.r.Root,{children:[(0,r.Y)(v.r.Closed,{value:"",children:(0,r.FD)(a.ProfileSection.Item,{id:"web3Wallets",align:"start",children:[(0,r.FD)(s.Flex,{sx:e=>({alignItems:"center",gap:e.space.$2,width:"100%"}),children:[n[o].iconUrl&&(0,r.Y)(s.Image,{src:n[o].iconUrl,alt:n[o].name,sx:e=>({width:e.sizes.$4})}),(0,r.Y)(s.Box,{sx:{whiteSpace:"nowrap",overflow:"hidden"},children:(0,r.FD)(s.Flex,{gap:2,justify:"start",children:[(0,r.FD)(s.Text,{children:[n[o].name," (",(i=e.web3Wallet,i.length<=10?i:i.slice(0,6)+"..."+i.slice(-4)),")"]}),(null==t?void 0:t.primaryWeb3WalletId)===e.id&&(0,r.Y)(s.Badge,{localizationKey:(0,s.localizationKeys)("badge__primary")}),"verified"!==e.verification.status&&(0,r.Y)(s.Badge,{localizationKey:(0,s.localizationKeys)("badge__unverified")})]})})]}),(0,r.Y)(he,{})]},e.id)}),(0,r.Y)(v.r.Open,{value:"remove",children:(0,r.Y)(v.r.Card,{variant:"destructive",children:(0,r.Y)(ue,{walletId:e.id})})})]},e.id);var i}))}),e&&(0,r.Y)(de,{})]})]}):null})),he=()=>{const{open:e}=(0,g.D5)(),o=[{label:(0,s.localizationKeys)("userProfile.start.web3WalletsSection.destructiveAction"),onClick:()=>e("remove")}].filter((e=>null!==e));return(0,r.Y)(a.ThreeDotsMenu,{actions:o})},pe=(0,a.withCardStateProvider)((()=>{var e;const{attributes:o,saml:t,social:i}=(0,n.useEnvironment)().userSettings,l=(0,a.useCardState)(),{user:c}=(0,h.Jd)(),d=o.username.enabled,u=o.email_address.enabled,m=o.phone_number.enabled,p=i&&Object.values(i).filter((e=>e.enabled)).length>0,f=t&&t.enabled&&c&&c.samlAccounts.length>0,v=o.web3_wallet.enabled,g=!f||!(null===(e=null==c?void 0:c.samlAccounts)||void 0===e?void 0:e.some((e=>{var o;return e.active&&(null===(o=e.samlConnection)||void 0===o?void 0:o.disableAdditionalIdentifications)})));return(0,r.Y)(s.Col,{elementDescriptor:s.descriptors.page,sx:e=>({gap:e.space.$8,color:e.colors.$colorText}),children:(0,r.FD)(s.Col,{elementDescriptor:s.descriptors.profilePage,elementId:s.descriptors.profilePage.setId("account"),children:[(0,r.Y)(a.Header.Root,{children:(0,r.Y)(a.Header.Title,{localizationKey:(0,s.localizationKeys)("userProfile.start.headerTitle__account"),sx:e=>({marginBottom:e.space.$4}),textVariant:"h2"})}),(0,r.Y)(a.Card.Alert,{children:l.error}),(0,r.Y)(le,{}),d&&(0,r.Y)(ie,{}),u&&(0,r.Y)(W,{shouldAllowCreation:g}),m&&(0,r.Y)(Z,{shouldAllowCreation:g}),p&&(0,r.Y)(k,{shouldAllowCreation:g}),f&&(0,r.Y)(q,{}),v&&(0,r.Y)(me,{shouldAllowCreation:g})]})})}));var fe=t(8313);const ve=()=>{const{user:e}=(0,h.Jd)(),{session:o}=(0,h.wV)(),{data:t,isLoading:i}=(0,y.st)(null==e?void 0:e.getSessions,"user-sessions");return(0,r.Y)(a.ProfileSection.Root,{title:(0,s.localizationKeys)("userProfile.start.activeDevicesSection.title"),centered:!1,id:"activeDevices",children:(0,r.Y)(a.ProfileSection.ItemList,{id:"activeDevices",disableAnimation:!0,children:i?(0,r.Y)(a.FullHeightLoader,{}):null==t?void 0:t.sort((n=o.id,e=>e.id===n?-1:1)).map((e=>"active"!==e.status?null:(0,r.Y)(ge,{session:e},e.id)))})});var n},ge=({session:e})=>{var o;const t=(null===(o=(0,h.wV)().session)||void 0===o?void 0:o.id)===e.id,i=(0,y.mN)(),{handleAssurance:n}=(0,P.r)();return(0,r.FD)(a.ProfileSection.Item,{id:"activeDevices",elementDescriptor:s.descriptors.activeDeviceListItem,elementId:t?s.descriptors.activeDeviceListItem.setId("current"):void 0,sx:{alignItems:"flex-start"},children:[i.isLoading&&(0,r.Y)(a.FullHeightLoader,{}),!i.isLoading&&(0,r.FD)(r.FK,{children:[(0,r.Y)(ye,{session:e}),!t&&(0,r.Y)(Pe,{revoke:async()=>{if(!t&&e)return i.setLoading(),n((()=>e.revoke())).catch((()=>{})).finally((()=>i.setIdle()))}})]})]})},ye=e=>{const{session:o}=(0,h.wV)(),t=(null==o?void 0:o.id)===e.session.id,i=!!(null==o?void 0:o.actor),n=!!e.session.actor,{city:a,country:l,browserName:c,browserVersion:d,deviceType:u,ipAddress:m,isMobile:p}=e.session.latestActivity,f=u||(p?"Mobile device":"Desktop device"),v=`${c||""} ${d||""}`.trim()||"Web browser",g=[a||"",l||""].filter(Boolean).join(", ").trim()||null,{t:y}=(0,s.useLocalizations)();return(0,r.FD)(s.Flex,{elementDescriptor:s.descriptors.activeDevice,elementId:t?s.descriptors.activeDevice.setId("current"):void 0,sx:e=>({width:"100%",overflow:"hidden",gap:e.space.$4,[oe.mqu.sm]:{gap:e.space.$2}}),children:[(0,r.Y)(s.Flex,{sx:e=>({[oe.mqu.sm]:{padding:"0"},borderRadius:e.radii.$md}),children:(0,r.Y)(s.Icon,{elementDescriptor:s.descriptors.activeDeviceIcon,elementId:s.descriptors.activeDeviceIcon.setId(p?"mobile":"desktop"),icon:p?fe.R2:fe.rI,sx:e=>({"--cl-chassis-bottom":"#444444","--cl-chassis-back":"#343434","--cl-chassis-screen":"#575757","--cl-screen":"#000000",width:e.space.$8,height:e.space.$8})})}),(0,r.FD)(s.Col,{align:"start",gap:1,children:[(0,r.FD)(s.Flex,{center:!0,gap:2,children:[(0,r.Y)(s.Text,{children:f}),t&&(0,r.Y)(s.Badge,{localizationKey:(0,s.localizationKeys)("badge__thisDevice"),colorScheme:i?"danger":"primary"}),i&&!n&&(0,r.Y)(s.Badge,{localizationKey:(0,s.localizationKeys)("badge__userDevice")}),!t&&n&&(0,r.Y)(s.Badge,{localizationKey:(0,s.localizationKeys)("badge__otherImpersonatorDevice"),colorScheme:"danger"})]}),(0,r.Y)(s.Text,{colorScheme:"secondary",children:v}),(0,r.FD)(s.Text,{colorScheme:"secondary",children:[m," (",g,")"]}),(0,r.Y)(s.Text,{colorScheme:"secondary",children:y((0,b.T$)(e.session.lastActiveAt))})]})]})},Pe=({revoke:e})=>{const o=[{label:(0,s.localizationKeys)("userProfile.start.activeDevicesSection.destructiveAction"),isDestructive:!0,onClick:e}].filter((e=>null!==e));return(0,r.Y)(a.ThreeDotsMenu,{actions:o})};var be=t(9029);const Ye=(0,a.withCardStateProvider)((e=>{const{onReset:o}=e,t=(0,a.useCardState)(),{navigateAfterSignOut:i,navigateAfterMultiSessionSingleSignOutUrl:l}=(0,n.useSignOutContext)(),{user:c}=(0,h.Jd)(),{t:d}=(0,s.useLocalizations)(),{otherSessions:u}=(0,be.z)({user:c}),{setActive:m}=(0,h.ho)(),{handleAssurance:p}=(0,P.r)(),f=(0,b.tJ)("deleteConfirmation","",{type:"text",label:(0,s.localizationKeys)("userProfile.deletePage.actionDescription"),isRequired:!0,placeholder:(0,s.localizationKeys)("formFieldInputPlaceholder__confirmDeletionUserAccount")}),v=f.value===(d((0,s.localizationKeys)("formFieldInputPlaceholder__confirmDeletionUserAccount"))||"Delete account");return(0,r.Y)(a.FormContainer,{headerTitle:(0,s.localizationKeys)("userProfile.deletePage.title"),sx:e=>({gap:e.space.$0x5}),children:(0,r.FD)(a.Form.Root,{onSubmit:async()=>{if(v)try{if(!c)throw Error("user is not defined");await p(c.delete);const e=0===u.length?i:l;return await m({session:null,beforeEmit:e})}catch(e){(0,b.H4)(e,[],t.setError)}},children:[(0,r.FD)(s.Col,{gap:1,children:[(0,r.Y)(s.Text,{colorScheme:"secondary",localizationKey:(0,s.localizationKeys)("userProfile.deletePage.messageLine1")}),(0,r.Y)(s.Text,{colorScheme:"danger",localizationKey:(0,s.localizationKeys)("userProfile.deletePage.messageLine2")})]}),(0,r.Y)(a.Form.ControlRow,{elementId:f.id,children:(0,r.Y)(a.Form.PlainInput,{...f.props,ignorePasswordManager:!0})}),(0,r.Y)(a.FormButtons,{submitLabel:(0,s.localizationKeys)("userProfile.deletePage.confirm"),colorScheme:"danger",isDisabled:!v,onReset:o})]})})})),Se=()=>{const{close:e}=(0,g.D5)();return(0,r.Y)(Ye,{onSuccess:e,onReset:e})},Ce=()=>(0,r.Y)(a.ProfileSection.Root,{title:(0,s.localizationKeys)("userProfile.start.dangerSection.title"),id:"danger",sx:{alignItems:"center",[oe.mqu.md]:{alignItems:"flex-start"}},children:(0,r.FD)(v.r.Root,{children:[(0,r.Y)(v.r.Closed,{value:"delete",children:(0,r.Y)(a.ProfileSection.Item,{id:"danger",sx:e=>({paddingLeft:e.space.$1}),children:(0,r.Y)(v.r.Trigger,{value:"delete",children:(0,r.Y)(a.ProfileSection.Button,{id:"danger",variant:"ghost",colorScheme:"danger",localizationKey:(0,s.localizationKeys)("userProfile.start.dangerSection.deleteAccountButton")})})})}),(0,r.Y)(v.r.Open,{value:"delete",children:(0,r.Y)(v.r.Card,{variant:"destructive",children:(0,r.Y)(Se,{})})})]})});var ze=t(8740);const Fe=e=>{const{code:o}=e;return(0,r.Y)(s.Flex,{center:!0,sx:e=>({padding:`${e.space.$1} ${e.space.$4}`}),children:(0,r.Y)(s.Text,{children:o})})},Ke=e=>{const{subtitle:o,backupCodes:t}=e,{applicationName:i}=(0,n.useEnvironment)().displayConfig,{user:a}=(0,h.Jd)(),{print:l,printableProps:c}=(0,f.hH)(),{onCopy:d,hasCopied:u}=(0,y.iD)((null==t?void 0:t.join(","))||"");if(!a)return null;const m=(0,ze.Cm)(a);return t?(0,r.FD)(r.FK,{children:[(0,r.FD)(s.Col,{gap:1,children:[(0,r.Y)(s.Text,{localizationKey:(0,s.localizationKeys)("userProfile.backupCodePage.title__codelist"),variant:"subtitle"}),(0,r.Y)(s.Text,{localizationKey:o,variant:"caption",colorScheme:"secondary"})]}),(0,r.FD)(s.Box,{sx:e=>({borderWidth:e.borderWidths.$normal,borderStyle:e.borderStyles.$solid,borderColor:e.colors.$neutralAlpha100,borderRadius:e.radii.$lg}),children:[(0,r.Y)(s.Grid,{gap:2,sx:e=>({gridTemplateColumns:`repeat(2, minmax(${e.sizes.$12}, 1fr))`,padding:`${e.space.$4} ${e.space.$6}`}),children:t.map(((e,o)=>(0,r.Y)(Fe,{code:e},o)))}),(0,r.FD)(s.Grid,{sx:e=>({borderTopWidth:e.borderWidths.$normal,borderTopStyle:e.borderStyles.$solid,borderTopColor:e.colors.$neutralAlpha100,gridTemplateColumns:"repeat(3, minmax(0, 1fr))",">:not([hidden])~:not([hidden])":{borderRightWidth:"0px",borderLeftWidth:"1px",borderStyle:"solid",borderColor:e.colors.$neutralAlpha100},">:first-child":{borderBottomLeftRadius:e.radii.$lg},">:last-child":{borderBottomRightRadius:e.radii.$lg}}),children:[(0,r.Y)(s.Button,{variant:"ghost",sx:e=>({width:"100%",padding:`${e.space.$2} 0`,borderRadius:0}),onClick:()=>{const e=document.createElement("a"),o=new Blob([_e(t,i,m)],{type:"text/plain"});e.href=URL.createObjectURL(o),e.download=`${i}_backup_codes.txt`,document.body.appendChild(e),e.click()},children:(0,r.Y)(s.Icon,{icon:fe.f5})}),(0,r.Y)(s.Button,{variant:"ghost",sx:e=>({width:"100%",padding:`${e.space.$2} 0`,borderRadius:0}),onClick:l,children:(0,r.Y)(s.Icon,{icon:fe.aS})}),(0,r.Y)(s.Button,{variant:"ghost",onClick:d,sx:e=>({width:"100%",padding:`${e.space.$2} 0`,borderRadius:0}),children:(0,r.Y)(s.Icon,{icon:u?fe.Jl:fe.QR})})]})]}),(0,r.FD)(f.LS,{...c,children:[(0,r.FD)(s.Heading,{children:["Your backup codes for ",i," account ",m,":"]}),(0,r.Y)(s.Col,{gap:2,children:t.map(((e,o)=>(0,r.Y)(Fe,{code:e},o)))})]})]}):null};function _e(e,o,t){return`These are your backup codes for ${o} account ${t}.\nStore them securely and keep them secret. Each code can only be used once.\n\n${null==e?void 0:e.join("\n")}`}const Re=(0,a.withCardStateProvider)((e=>{const{onSuccess:o}=e,{user:t}=(0,h.Jd)(),n=(0,a.useCardState)(),{handleAssurance:l}=(0,P.r)(),[c,d]=i.useState(void 0);return i.useEffect((()=>{!c&&t&&l(t.createBackupCode).then((e=>d(e))).catch((e=>(0,b.H4)(e,[],n.setError)))}),[]),n.error?(0,r.Y)(a.FormContainer,{headerTitle:(0,s.localizationKeys)("userProfile.backupCodePage.title")}):(0,r.Y)(a.FormContainer,{headerTitle:(0,s.localizationKeys)("userProfile.backupCodePage.title"),children:c?(0,r.FD)(r.FK,{children:[(0,r.Y)(s.Text,{localizationKey:(0,s.localizationKeys)("userProfile.backupCodePage.successMessage")}),(0,r.Y)(Ke,{subtitle:(0,s.localizationKeys)("userProfile.backupCodePage.subtitle__codelist"),backupCodes:c.codes}),(0,r.Y)(a.FormButtonContainer,{children:(0,r.Y)(s.Button,{autoFocus:!0,onClick:o,localizationKey:(0,s.localizationKeys)("userProfile.formButtonPrimary__finish"),elementDescriptor:s.descriptors.formButtonPrimary})})]}):(0,r.Y)(a.FullHeightLoader,{})})})),xe=(0,a.withCardStateProvider)((e=>{const{onSuccess:o,onReset:t}=e,i=(0,f.Xi)();return(0,r.FD)(f.sQ,{...i.props,children:[(0,r.Y)(De,{onContinue:i.nextStep}),(0,r.Y)(Re,{onSuccess:o,onReset:t})]})})),De=e=>{const{onContinue:o}=e,{close:t}=(0,g.D5)();return(0,r.FD)(a.FormContainer,{headerTitle:(0,s.localizationKeys)("userProfile.backupCodePage.title"),children:[(0,r.Y)(s.Text,{localizationKey:(0,s.localizationKeys)("userProfile.backupCodePage.infoText1")}),(0,r.Y)(s.Text,{localizationKey:(0,s.localizationKeys)("userProfile.backupCodePage.infoText2")}),(0,r.FD)(a.FormButtonContainer,{sx:{marginTop:0},children:[(0,r.Y)(s.Button,{textVariant:"buttonSmall",onClick:o,localizationKey:(0,s.localizationKeys)("userProfile.formButtonPrimary__finish"),elementDescriptor:s.descriptors.formButtonPrimary}),(0,r.Y)(s.Button,{variant:"ghost",onClick:t,localizationKey:(0,s.localizationKeys)("userProfile.formButtonReset"),elementDescriptor:s.descriptors.formButtonReset})]})]})},ke=(0,a.withCardStateProvider)((e=>{var o;const{onReset:t,onSuccess:l}=e,c=i.useRef(),d=(0,f.Xi)({defaultStep:2}),u=(0,n.useEnvironment)().userSettings.attributes.backup_code.enabled;return(0,r.FD)(f.sQ,{...d.props,children:[(0,r.Y)(j,{title:(0,s.localizationKeys)("userProfile.phoneNumberPage.title"),resourceRef:c,onSuccess:d.nextStep,onUseExistingNumberClick:()=>d.goToStep(2),onReset:t}),(0,r.Y)(G,{title:(0,s.localizationKeys)("userProfile.mfaPhoneCodePage.title"),resourceRef:c,onSuccess:d.nextStep,onReset:()=>d.goToStep(2)}),(0,r.Y)(we,{onSuccess:u?d.nextStep:l,onReset:t,onAddPhoneClick:()=>d.goToStep(0),onUnverifiedPhoneClick:e=>{c.current=e,d.goToStep(1)},title:(0,s.localizationKeys)("userProfile.mfaPhoneCodePage.title"),resourceRef:c}),u&&(0,r.Y)(a.SuccessPage,{title:(0,s.localizationKeys)("userProfile.mfaPhoneCodePage.successTitle"),text:[(0,s.localizationKeys)("userProfile.mfaPhoneCodePage.successMessage1"),(0,s.localizationKeys)("userProfile.mfaPhoneCodePage.successMessage2")],onFinish:t,contents:(0,r.Y)(Ke,{backupCodes:null===(o=c.current)||void 0===o?void 0:o.backupCodes})})]})})),we=e=>{const{onSuccess:o,onReset:t,title:i,onAddPhoneClick:n,onUnverifiedPhoneClick:l,resourceRef:c}=e,d=(0,a.useCardState)(),{user:u}=(0,h.Jd)(),{handleAssurance:m}=(0,P.r)();if(!u)return null;const p=u.phoneNumbers.filter((e=>!e.reservedForSecondFactor));return(0,r.FD)(a.FormContainer,{headerTitle:i,gap:1,children:[(0,r.Y)(s.Text,{localizationKey:(0,s.localizationKeys)(p.length?"userProfile.mfaPhoneCodePage.subtitle__availablePhoneNumbers":"userProfile.mfaPhoneCodePage.subtitle__unavailablePhoneNumbers"),colorScheme:"secondary"}),p.length>0&&(0,r.Y)(s.Col,{gap:2,children:p.map((e=>{const{country:t}=(0,b.Mz)(e.phoneNumber),i=(0,b.Om)(e.phoneNumber);return(0,r.FD)(s.Button,{variant:"outline",colorScheme:"neutral",sx:{justifyContent:"start"},onClick:()=>(async e=>{if("verified"!==e.verification.status)return l(e);d.setLoading(e.id);try{await m((()=>e.setReservedForSecondFactor({reserved:!0}))),c.current=e,o()}catch(t){(0,b.H4)(t,[],d.setError)}finally{d.setIdle()}})(e),isLoading:d.loadingMetadata===e.id,isDisabled:d.isLoading,children:[t.iso.toUpperCase()," ",i]},e.id)}))}),(0,r.FD)(a.FormButtonContainer,{sx:{flexDirection:"row",justifyContent:"space-between"},children:[(0,r.Y)(a.IconButton,{variant:"ghost","aria-label":"Add phone number",icon:(0,r.Y)(s.Icon,{icon:fe.FW,sx:e=>({marginRight:e.space.$2})}),localizationKey:(0,s.localizationKeys)("userProfile.mfaPhoneCodePage.primaryButton__addPhoneNumber"),onClick:n}),(0,r.Y)(s.Button,{variant:"ghost",localizationKey:(0,s.localizationKeys)("userProfile.formButtonReset"),onClick:t})]})]})};var Te=t(8174);const Ae=(0,a.withCardStateProvider)((e=>{const{title:o,onSuccess:t,onReset:n}=e,{user:l}=(0,h.Jd)(),c=(0,a.useCardState)(),{handleAssurance:d}=(0,P.r)(),{close:u}=(0,g.D5)(),[m,p]=i.useState(void 0),[v,y]=i.useState("qr");return i.useEffect((()=>{l&&d(l.createTOTP).then((e=>p(e))).catch((e=>(0,Te.Cm)(e)&&"assurance_cancelled"===e.code?u():(0,b.H4)(e,[],c.setError)))}),[]),c.error?(0,r.Y)(a.FormContainer,{headerTitle:o}):(0,r.FD)(a.FormContainer,{headerTitle:o,headerSubtitle:"qr"==v?(0,s.localizationKeys)("userProfile.mfaTOTPPage.authenticatorApp.infoText__ableToScan"):(0,s.localizationKeys)("userProfile.mfaTOTPPage.authenticatorApp.infoText__unableToScan"),children:[!m&&(0,r.Y)(a.FullHeightLoader,{}),m&&(0,r.FD)(r.FK,{children:[(0,r.FD)(s.Col,{gap:4,children:["qr"==v&&(0,r.Y)(f.rg,{justify:"center",url:m.uri||""}),"uri"==v&&(0,r.FD)(r.FK,{children:[(0,r.Y)(s.Text,{colorScheme:"secondary",localizationKey:(0,s.localizationKeys)("userProfile.mfaTOTPPage.authenticatorApp.inputLabel__unableToScan1")}),(0,r.Y)(a.ClipboardInput,{value:m.secret}),(0,r.Y)(s.Text,{colorScheme:"secondary",localizationKey:(0,s.localizationKeys)("userProfile.mfaTOTPPage.authenticatorApp.inputLabel__unableToScan2")}),(0,r.Y)(a.ClipboardInput,{value:m.uri})]})]}),(0,r.FD)(s.Flex,{justify:"between",align:"center",sx:{width:"100%"},children:["qr"==v&&(0,r.Y)(s.Button,{variant:"link",textVariant:"buttonLarge",onClick:()=>y("uri"),localizationKey:(0,s.localizationKeys)("userProfile.mfaTOTPPage.authenticatorApp.buttonUnableToScan__nonPrimary")}),"uri"==v&&(0,r.Y)(s.Button,{variant:"link",textVariant:"buttonLarge",onClick:()=>y("qr"),localizationKey:(0,s.localizationKeys)("userProfile.mfaTOTPPage.authenticatorApp.buttonAbleToScan__nonPrimary")}),(0,r.FD)(a.FormButtonContainer,{children:[(0,r.Y)(s.Button,{onClick:t,localizationKey:(0,s.localizationKeys)("userProfile.formButtonPrimary__continue"),elementDescriptor:s.descriptors.formButtonPrimary}),(0,r.Y)(s.Button,{variant:"ghost",onClick:n,localizationKey:(0,s.localizationKeys)("userProfile.formButtonReset"),elementDescriptor:s.descriptors.formButtonReset})]})]})]})]})})),Ie=(0,a.withCardStateProvider)((e=>{const{onSuccess:o,onReset:t,resourceRef:i}=e,{user:n}=(0,h.Jd)(),l=(0,a.useFieldOTP)({onCodeEntryFinished:(e,o,t)=>{null==n||n.verifyTOTP({code:e}).then((e=>o(e))).catch(t)},onResolve:e=>{i.current=e,o()}});return(0,r.FD)(a.FormContainer,{headerTitle:(0,s.localizationKeys)("userProfile.mfaTOTPPage.title"),children:[(0,r.Y)(s.Col,{children:(0,r.Y)(a.Form.OTPInput,{...l,label:(0,s.localizationKeys)("userProfile.mfaTOTPPage.verifyTitle"),description:(0,s.localizationKeys)("userProfile.mfaTOTPPage.verifySubtitle")})}),(0,r.Y)(a.FormButtonContainer,{sx:{marginTop:0},children:(0,r.Y)(s.Button,{onClick:t,variant:"ghost",isDisabled:l.isLoading,localizationKey:(0,s.localizationKeys)("userProfile.formButtonReset"),elementDescriptor:s.descriptors.formButtonReset})})]})})),Be=(0,a.withCardStateProvider)((e=>{var o;const{onReset:t}=e,n=(0,f.Xi)(),l=i.useRef();return(0,r.FD)(f.sQ,{...n.props,children:[(0,r.Y)(Ae,{title:(0,s.localizationKeys)("userProfile.mfaTOTPPage.title"),onSuccess:n.nextStep,onReset:t}),(0,r.Y)(Ie,{onSuccess:n.nextStep,onReset:t,resourceRef:l}),(0,r.Y)(a.SuccessPage,{title:(0,s.localizationKeys)("userProfile.mfaTOTPPage.title"),text:(0,s.localizationKeys)("userProfile.mfaTOTPPage.successMessage"),onFinish:t,contents:(0,r.Y)(Ke,{subtitle:(0,s.localizationKeys)("userProfile.backupCodePage.successSubtitle"),backupCodes:null===(o=l.current)||void 0===o?void 0:o.backupCodes})})]})})),Le=(0,a.withCardStateProvider)((e=>{const{onSuccess:o,onReset:t,selectedStrategy:l}=e,c=(0,a.useCardState)(),{userSettings:{attributes:d}}=(0,n.useEnvironment)(),{user:u}=(0,h.Jd)();if(!u)return null;const m=(0,s.localizationKeys)("userProfile.mfaPage.title"),p=i.useMemo((()=>B(d,u)),[]);return i.useEffect((()=>{0===p.length&&c.setError("There are no second factors available to add")}),[]),c.error?(0,r.Y)(a.FormContainer,{headerTitle:m}):0!==p.length||l?(0,r.Y)($e,{onSuccess:o,onReset:t,method:l||p[0]}):null})),$e=e=>{const{method:o,onSuccess:t,onReset:i}=e;switch(o){case"phone_code":return(0,r.Y)(ke,{onSuccess:t,onReset:i});case"totp":return(0,r.Y)(Be,{onSuccess:t,onReset:i});case"backup_code":return(0,r.Y)(xe,{onSuccess:t,onReset:i});default:return null}},Ee=()=>{const{close:e}=(0,g.D5)();return(0,r.Y)(_,{onSuccess:e,onReset:e})},Ne=e=>{const{close:o}=(0,g.D5)();return(0,r.Y)(K,{onSuccess:o,onReset:o,...e})},Ue=()=>{const{close:e}=(0,g.D5)();return(0,r.Y)(Re,{onSuccess:e,onReset:e})},Oe=e=>{const{close:o}=(0,g.D5)();return(0,r.Y)(Le,{onSuccess:o,onReset:o,selectedStrategy:e.selectedStrategy})},Me=()=>{const{userSettings:{attributes:e}}=(0,n.useEnvironment)(),{user:o}=(0,h.Jd)();if(!o)return null;const t=I(e),i=B(e,o),l=t.includes("totp")&&o.totpEnabled,c=t.includes("backup_code")&&o.backupCodeEnabled,d=o.phoneNumbers.filter((e=>"verified"===e.verification.status)).filter((e=>e.reservedForSecondFactor)).sort(A);return(0,r.Y)(a.ProfileSection.Root,{title:(0,s.localizationKeys)("userProfile.start.mfaSection.title"),centered:!1,id:"mfa",children:(0,r.Y)(v.r.Root,{children:(0,r.FD)(a.ProfileSection.ItemList,{id:"mfa",children:[l&&(0,r.FD)(v.r.Root,{children:[(0,r.FD)(a.ProfileSection.Item,{id:"mfa",hoverable:!0,children:[(0,r.FD)(s.Flex,{sx:e=>({gap:e.space.$2,alignItems:"center"}),children:[(0,r.Y)(s.Icon,{icon:fe.c6,sx:e=>({color:e.colors.$neutralAlpha700})}),(0,r.Y)(s.Text,{localizationKey:(0,s.localizationKeys)("userProfile.start.mfaSection.totp.headerTitle")}),(0,r.Y)(s.Badge,{localizationKey:(0,s.localizationKeys)("badge__default")})]}),(0,r.Y)(He,{})]}),(0,r.Y)(v.r.Open,{value:"remove",children:(0,r.Y)(v.r.Card,{variant:"destructive",children:(0,r.Y)(Ee,{})})})]}),t.includes("phone_code")&&d.map((e=>{const o=!l&&e.defaultSecondFactor;return(0,r.FD)(v.r.Root,{children:[(0,r.FD)(a.ProfileSection.Item,{id:"mfa",hoverable:!0,children:[(0,r.FD)(s.Flex,{sx:e=>({gap:e.space.$2,alignItems:"center"}),children:[(0,r.Y)(s.Icon,{icon:fe.fq,sx:e=>({color:e.colors.$neutralAlpha700})}),(0,r.FD)(s.Text,{children:["SMS Code ",(0,r.Y)(a.FormattedPhoneNumberText,{value:e.phoneNumber})]}),o&&(0,r.Y)(s.Badge,{localizationKey:(0,s.localizationKeys)("badge__default")})]}),(0,r.Y)(Je,{phone:e,showTOTP:l})]}),(0,r.Y)(v.r.Open,{value:"remove",children:(0,r.Y)(v.r.Card,{variant:"destructive",children:(0,r.Y)(Ne,{phoneId:e.id})})})]},e.id)})),c&&(0,r.FD)(v.r.Root,{children:[(0,r.FD)(a.ProfileSection.Item,{id:"mfa",hoverable:!0,children:[(0,r.FD)(s.Flex,{sx:e=>({gap:e.space.$2,alignItems:"center"}),children:[(0,r.Y)(s.Icon,{icon:fe.G6,sx:e=>({color:e.colors.$neutralAlpha700})}),(0,r.Y)(s.Text,{localizationKey:(0,s.localizationKeys)("userProfile.start.mfaSection.backupCodes.headerTitle")})]}),(0,r.Y)(We,{})]}),(0,r.Y)(v.r.Open,{value:"regenerate",children:(0,r.Y)(v.r.Card,{children:(0,r.Y)(Ue,{})})})]}),(0,r.Y)(qe,{secondFactorsAvailableToAdd:i})]})})})},Je=({phone:e,showTOTP:o})=>{const{open:t}=(0,g.D5)(),i=(0,a.useCardState)(),n=[o?null:{label:(0,s.localizationKeys)("userProfile.start.mfaSection.phoneCode.actionLabel__setDefault"),onClick:()=>e.makeDefaultSecondFactor().catch((e=>(0,b.H4)(e,[],i.setError))),isDisabled:e.defaultSecondFactor},{label:(0,s.localizationKeys)("userProfile.start.mfaSection.phoneCode.destructiveActionLabel"),isDestructive:!0,onClick:()=>t("remove")}].filter((e=>null!==e));return(0,r.Y)(a.ThreeDotsMenu,{actions:n})},We=()=>{const{open:e}=(0,g.D5)(),o=[{label:(0,s.localizationKeys)("userProfile.start.mfaSection.backupCodes.actionLabel__regenerate"),onClick:()=>e("regenerate")}].filter((e=>null!==e));return(0,r.Y)(a.ThreeDotsMenu,{actions:o})},He=()=>{const{open:e}=(0,g.D5)(),o=[{label:(0,s.localizationKeys)("userProfile.start.mfaSection.totp.destructiveActionTitle"),isDestructive:!0,onClick:()=>e("remove")}].filter((e=>null!==e));return(0,r.Y)(a.ThreeDotsMenu,{actions:o})},qe=e=>{const{open:o}=(0,g.D5)(),{secondFactorsAvailableToAdd:t}=e,[n,l]=(0,i.useState)(),c=i.useMemo((()=>t.map((e=>"phone_code"===e?{icon:fe.fq,text:"SMS code",key:"phone_code"}:"totp"===e?{icon:fe.c6,text:"Authenticator application",key:"totp"}:"backup_code"===e?{icon:fe.G6,text:"Backup code",key:"backup_code"}:null)).filter((e=>null!==e))),[t]);return(0,r.FD)(r.FK,{children:[t.length>0&&(0,r.Y)(v.r.Closed,{value:"multi-factor",children:(0,r.Y)(a.ProfileSection.ActionMenu,{id:"mfa",triggerLocalizationKey:(0,s.localizationKeys)("userProfile.start.mfaSection.primaryButton"),children:c.map((e=>e&&(0,r.Y)(a.ProfileSection.ActionMenuItem,{id:e.key,localizationKey:e.text,leftIcon:e.icon,onClick:()=>{l(e.key),o("multi-factor")}},e.key)))})}),(0,r.Y)(v.r.Open,{value:"multi-factor",children:(0,r.Y)(v.r.Card,{children:n&&(0,r.Y)(Oe,{selectedStrategy:n})})})]})},Ve=e=>{const{close:o}=(0,g.D5)();return(0,r.Y)(R,{onSuccess:o,onReset:o,...e})},je=e=>{const{close:o}=(0,g.D5)();return(0,r.Y)(Ge,{onSuccess:o,onReset:o,passkey:e.passkey})},Ge=(0,a.withCardStateProvider)((e=>{const{onSuccess:o,onReset:t,passkey:i}=e,n=(0,a.useCardState)(),l=(0,b.tJ)("passkeyName",i.name||"",{type:"text",label:(0,s.localizationKeys)("formFieldLabel__passkeyName"),isRequired:!0}),c=l.value.length>1&&i.name!==l.value;return(0,r.Y)(a.FormContainer,{headerTitle:(0,s.localizationKeys)("userProfile.passkeyScreen.title__rename"),headerSubtitle:(0,s.localizationKeys)("userProfile.passkeyScreen.subtitle__rename"),children:(0,r.FD)(a.Form.Root,{onSubmit:async e=>(e.preventDefault(),i.update({name:l.value}).then(o).catch((e=>(0,b.H4)(e,[l],n.setError)))),children:[(0,r.Y)(a.Form.ControlRow,{elementId:l.id,children:(0,r.Y)(a.Form.PlainInput,{...l.props,autoComplete:"off"})}),(0,r.Y)(a.FormButtons,{submitLabel:(0,s.localizationKeys)("userProfile.formButtonPrimary__save"),isDisabled:!c,onReset:t})]})})})),Qe=()=>{const{user:e}=(0,h.Jd)();return e?(0,r.Y)(a.ProfileSection.Root,{title:(0,s.localizationKeys)("userProfile.start.passkeysSection.title"),centered:!1,id:"passkeys",children:(0,r.FD)(a.ProfileSection.ItemList,{id:"passkeys",children:[e.passkeys.map((e=>(0,r.FD)(v.r.Root,{children:[(0,r.Y)(Xe,{...e},e.id),(0,r.Y)(v.r.Open,{value:"remove",children:(0,r.Y)(v.r.Card,{variant:"destructive",children:(0,r.Y)(Ve,{passkey:e})})}),(0,r.Y)(v.r.Open,{value:"rename",children:(0,r.Y)(v.r.Card,{children:(0,r.Y)(je,{passkey:e})})})]},e.id))),(0,r.Y)(oo,{})]})}):null},Xe=e=>(0,r.FD)(a.ProfileSection.Item,{id:"passkeys",hoverable:!0,sx:{alignItems:"flex-start"},children:[(0,r.Y)(Ze,{...e}),(0,r.Y)(eo,{})]}),Ze=e=>{const{name:o,createdAt:t,lastUsedAt:i}=e,{t:n}=(0,s.useLocalizations)();return(0,r.Y)(s.Flex,{sx:e=>({width:"100%",overflow:"hidden",gap:e.space.$4,[oe.mqu.sm]:{gap:e.space.$2}}),children:(0,r.FD)(s.Col,{align:"start",gap:1,children:[(0,r.Y)(s.Text,{children:o}),(0,r.FD)(s.Text,{colorScheme:"secondary",children:["Created: ",n((0,b.T$)(t))]}),i&&(0,r.FD)(s.Text,{colorScheme:"secondary",children:["Last used: ",n((0,b.T$)(i))]})]})})},eo=()=>{const{open:e}=(0,g.D5)(),o=[{label:(0,s.localizationKeys)("userProfile.start.passkeysSection.menuAction__rename"),onClick:()=>e("rename")},{label:(0,s.localizationKeys)("userProfile.start.passkeysSection.menuAction__destructive"),isDestructive:!0,onClick:()=>e("remove")}];return(0,r.Y)(a.ThreeDotsMenu,{actions:o})},oo=()=>{const e=(0,a.useCardState)(),{isSatellite:o}=(0,h.ho)(),{user:t}=(0,h.Jd)(),{handleAssurance:i}=(0,P.r)();return o?null:(0,r.Y)(a.ProfileSection.ArrowButton,{id:"passkeys",localizationKey:"Add a passkey",onClick:async()=>{if(t)try{await i(t.createPasskey)}catch(o){(0,b.H4)(o,[],e.setError)}}})},to=(e,o)=>{const t=[];return e?t.push((0,s.localizationKeys)("userProfile.passwordPage.successMessage__update")):t.push((0,s.localizationKeys)("userProfile.passwordPage.successMessage__set")),o&&t.push((0,s.localizationKeys)("userProfile.passwordPage.successMessage__signOutOfOtherSessions")),t},ro=(0,a.withCardStateProvider)((e=>{const{onSuccess:o,onReset:t}=e,{user:l}=(0,h.Jd)(),{handleAssurance:c}=(0,P.r)();if(!l)return null;const{session:d}=(0,h.wV)(),u=l.passwordEnabled?(0,s.localizationKeys)("userProfile.passwordPage.title__update"):(0,s.localizationKeys)("userProfile.passwordPage.title__set"),m=(0,a.useCardState)(),p=l.samlAccounts.some((e=>e.active)),f=(0,i.useRef)({title:(0,s.localizationKeys)("userProfile.passwordPage.title__set")}),v=(0,b.tJ)("currentPassword","",{type:"password",label:(0,s.localizationKeys)("formFieldLabel__currentPassword"),isRequired:!0}),{userSettings:{passwordSettings:g}}=(0,n.useEnvironment)(),Y=(0,b.tJ)("newPassword","",{type:"password",label:(0,s.localizationKeys)("formFieldLabel__newPassword"),isRequired:!0,validatePassword:!0,buildErrorMessage:e=>(0,b.C5)(e,{t:K,locale:_,passwordSettings:g})}),S=(0,b.tJ)("confirmPassword","",{type:"password",label:(0,s.localizationKeys)("formFieldLabel__confirmPassword"),isRequired:!0}),C=(0,b.tJ)("signOutOfOtherSessions","",{type:"checkbox",label:(0,s.localizationKeys)("formFieldLabel__signOutOfOtherSessions"),defaultChecked:!0}),{setConfirmPasswordFeedback:z,isPasswordMatch:F}=(0,y.Zg)({passwordField:Y,confirmPasswordField:S}),{t:K,locale:_}=(0,s.useLocalizations)(),R=(l.passwordEnabled?v.value&&F:F)&&Y.value&&S.value;return(0,r.FD)(a.FormContainer,{headerTitle:u,children:[p&&(0,r.Y)(a.InformationBox,{message:(0,s.localizationKeys)("userProfile.passwordPage.readonly")}),(0,r.FD)(a.Form.Root,{onSubmit:async()=>{const e={newPassword:Y.value,signOutOfOtherSessions:C.checked,currentPassword:l.passwordEnabled?v.value:void 0};try{f.current={title:l.passwordEnabled?(0,s.localizationKeys)("userProfile.passwordPage.title__update"):(0,s.localizationKeys)("userProfile.passwordPage.title__set"),text:to(l.passwordEnabled,!!C.checked)},await c((()=>l.updatePassword(e))),o()}catch(t){(0,b.H4)(t,[v,Y,S],m.setError)}},onBlur:()=>{Y.value&&z(S.value)},children:[(0,r.Y)("input",{readOnly:!0,"data-testid":"hidden-identifier",id:"identifier-field",name:"identifier",value:(null==d?void 0:d.publicUserData.identifier)||"",style:{display:"none"}}),l.passwordEnabled&&(0,r.Y)(a.Form.ControlRow,{elementId:v.id,children:(0,r.Y)(a.Form.PasswordInput,{...v.props,minLength:6,isRequired:!0,autoFocus:!0,isDisabled:p})}),(0,r.Y)(a.Form.ControlRow,{elementId:Y.id,children:(0,r.Y)(a.Form.PasswordInput,{...Y.props,minLength:6,isRequired:!0,autoFocus:!l.passwordEnabled,isDisabled:p})}),(0,r.Y)(a.Form.ControlRow,{elementId:S.id,children:(0,r.Y)(a.Form.PasswordInput,{...S.props,onChange:e=>(e.target.value&&z(e.target.value),S.props.onChange(e)),isRequired:!0,isDisabled:p})}),(0,r.Y)(a.Form.ControlRow,{elementId:C.id,children:(0,r.Y)(a.Form.Checkbox,{...C.props,description:(0,s.localizationKeys)("userProfile.passwordPage.checkboxInfoText__signOutOfOtherSessions"),isDisabled:p})}),p?(0,r.Y)(a.FormButtonContainer,{children:(0,r.Y)(a.Form.ResetButton,{localizationKey:(0,s.localizationKeys)("userProfile.formButtonReset"),block:!1,onClick:t})}):(0,r.Y)(a.FormButtons,{isDisabled:!R,onReset:t})]})]})})),io=()=>{const{close:e}=(0,g.D5)();return(0,r.Y)(ro,{onSuccess:e,onReset:e})},no=()=>{const{user:e}=(0,h.Jd)();if(!e)return null;const{passwordEnabled:o}=e;return(0,r.Y)(a.ProfileSection.Root,{centered:!1,title:(0,s.localizationKeys)("userProfile.start.passwordSection.title"),id:"password",children:(0,r.FD)(v.r.Root,{children:[(0,r.Y)(v.r.Closed,{value:"edit",children:(0,r.FD)(a.ProfileSection.Item,{id:"password",sx:e=>({paddingLeft:o?void 0:"0",paddingTop:e.space.$0x25,paddingBottom:e.space.$0x25}),children:[o&&(0,r.Y)(s.Text,{variant:"h2",children:"••••••••••"}),(0,r.Y)(v.r.Trigger,{value:"edit",children:(0,r.Y)(a.ProfileSection.Button,{id:"password",localizationKey:o?(0,s.localizationKeys)("userProfile.start.passwordSection.primaryButton__updatePassword"):(0,s.localizationKeys)("userProfile.start.passwordSection.primaryButton__setPassword")})})]})}),(0,r.Y)(v.r.Open,{value:"edit",children:(0,r.Y)(v.r.Card,{children:(0,r.Y)(io,{})})})]})})},so=(0,a.withCardStateProvider)((()=>{const{attributes:e,instanceIsPasswordBased:o}=(0,n.useEnvironment)().userSettings,t=(0,a.useCardState)(),{user:i}=(0,h.Jd)(),l=o,c=e.passkey.enabled,d=I(e).length>0,u=null==i?void 0:i.deleteSelfEnabled;return(0,r.Y)(s.Col,{elementDescriptor:s.descriptors.page,sx:e=>({gap:e.space.$8}),children:(0,r.FD)(s.Col,{elementDescriptor:s.descriptors.profilePage,elementId:s.descriptors.profilePage.setId("security"),children:[(0,r.Y)(a.Header.Root,{children:(0,r.Y)(a.Header.Title,{localizationKey:(0,s.localizationKeys)("userProfile.start.headerTitle__security"),sx:e=>({marginBottom:e.space.$4}),textVariant:"h2"})}),(0,r.Y)(a.Card.Alert,{children:t.error}),l&&(0,r.Y)(no,{}),c&&(0,r.Y)(Qe,{}),d&&(0,r.Y)(Me,{}),(0,r.Y)(ve,{}),u&&(0,r.Y)(Ce,{})]})})})),ao=()=>{var e;const{pages:o}=(0,n.useUserProfileContext)(),t=o.routes[0].id===m.j2.ACCOUNT,i=o.routes[0].id===m.j2.SECURITY,s=null===(e=o.contents)||void 0===e?void 0:e.map(((e,o)=>{const n=!t&&!i&&0===o;return(0,r.Y)(l.Route,{index:n,path:n?void 0:e.url,children:(0,r.Y)(u.H,{mount:e.mount,unmount:e.unmount})},`custom-page-${e.url}`)}));return(0,r.FD)(l.Switch,{children:[s,(0,r.FD)(l.Route,{children:[(0,r.Y)(l.Route,{path:t?void 0:"account",children:(0,r.Y)(l.Switch,{children:(0,r.Y)(l.Route,{index:!0,children:(0,r.Y)(pe,{})})})}),(0,r.Y)(l.Route,{path:i?void 0:"security",children:(0,r.Y)(l.Switch,{children:(0,r.Y)(l.Route,{index:!0,children:(0,r.Y)(so,{})})})})]})]})},lo=(0,n.withCoreUserGuard)((()=>{const e=i.useRef(null);return(0,r.Y)(a.ProfileCard.Root,{children:(0,r.FD)(d,{contentRef:e,children:[(0,r.Y)(a.NavbarMenuButtonRow,{navbarTitleLocalizationKey:(0,s.localizationKeys)("userProfile.navbar.title")}),(0,r.Y)(a.ProfileCard.Content,{contentRef:e,children:(0,r.Y)(ao,{})})]})})})),co=(0,a.withCardStateProvider)((e=>(0,r.Y)(s.Flow.Root,{flow:"userProfile",children:(0,r.Y)(s.Flow.Part,{children:(0,r.FD)(l.Switch,{children:[(0,r.Y)(l.Route,{path:"verify",children:(0,r.Y)(U,{})}),(0,r.Y)(l.Route,{children:(0,r.Y)(lo,{})})]})})}))),uo=e=>{const o={...e,routing:"virtual",componentName:"UserProfile",mode:"modal"};return(0,r.Y)(l.Route,{path:"user",children:(0,r.Y)(n.ComponentContext.Provider,{value:o,children:(0,r.Y)("div",{children:(0,r.Y)(co,{...o})})})})}},7007:function(e,o,t){t.d(o,{Re:function(){return i},XW:function(){return n},zN:function(){return r}});var r=[{provider:"google",strategy:"oauth_google",name:"Google",docsUrl:"https://clerk.com/docs/authentication/social-connections/google"},{provider:"discord",strategy:"oauth_discord",name:"Discord",docsUrl:"https://clerk.com/docs/authentication/social-connections/discord"},{provider:"facebook",strategy:"oauth_facebook",name:"Facebook",docsUrl:"https://clerk.com/docs/authentication/social-connections/facebook"},{provider:"twitch",strategy:"oauth_twitch",name:"Twitch",docsUrl:"https://clerk.com/docs/authentication/social-connections/twitch"},{provider:"twitter",strategy:"oauth_twitter",name:"Twitter",docsUrl:"https://clerk.com/docs/authentication/social-connections/twitter"},{provider:"microsoft",strategy:"oauth_microsoft",name:"Microsoft",docsUrl:"https://clerk.com/docs/authentication/social-connections/microsoft"},{provider:"tiktok",strategy:"oauth_tiktok",name:"TikTok",docsUrl:"https://clerk.com/docs/authentication/social-connections/tiktok"},{provider:"linkedin",strategy:"oauth_linkedin",name:"LinkedIn",docsUrl:"https://clerk.com/docs/authentication/social-connections/linkedin"},{provider:"linkedin_oidc",strategy:"oauth_linkedin_oidc",name:"LinkedIn",docsUrl:"https://clerk.com/docs/authentication/social-connections/linkedin-oidc"},{provider:"github",strategy:"oauth_github",name:"GitHub",docsUrl:"https://clerk.com/docs/authentication/social-connections/github"},{provider:"gitlab",strategy:"oauth_gitlab",name:"GitLab",docsUrl:"https://clerk.com/docs/authentication/social-connections/gitlab"},{provider:"dropbox",strategy:"oauth_dropbox",name:"Dropbox",docsUrl:"https://clerk.com/docs/authentication/social-connections/dropbox"},{provider:"atlassian",strategy:"oauth_atlassian",name:"Atlassian",docsUrl:"https://clerk.com/docs/authentication/social-connections/atlassian"},{provider:"bitbucket",strategy:"oauth_bitbucket",name:"Bitbucket",docsUrl:"https://clerk.com/docs/authentication/social-connections/bitbucket"},{provider:"hubspot",strategy:"oauth_hubspot",name:"HubSpot",docsUrl:"https://clerk.com/docs/authentication/social-connections/hubspot"},{provider:"notion",strategy:"oauth_notion",name:"Notion",docsUrl:"https://clerk.com/docs/authentication/social-connections/notion"},{provider:"apple",strategy:"oauth_apple",name:"Apple",docsUrl:"https://clerk.com/docs/authentication/social-connections/apple"},{provider:"line",strategy:"oauth_line",name:"LINE",docsUrl:"https://clerk.com/docs/authentication/social-connections/line"},{provider:"instagram",strategy:"oauth_instagram",name:"Instagram",docsUrl:"https://clerk.com/docs/authentication/social-connections/instagram"},{provider:"coinbase",strategy:"oauth_coinbase",name:"Coinbase",docsUrl:"https://clerk.com/docs/authentication/social-connections/coinbase"},{provider:"spotify",strategy:"oauth_spotify",name:"Spotify",docsUrl:"https://clerk.com/docs/authentication/social-connections/spotify"},{provider:"xero",strategy:"oauth_xero",name:"Xero",docsUrl:"https://clerk.com/docs/authentication/social-connections/xero"},{provider:"box",strategy:"oauth_box",name:"Box",docsUrl:"https://clerk.com/docs/authentication/social-connections/box"},{provider:"slack",strategy:"oauth_slack",name:"Slack",docsUrl:"https://clerk.com/docs/authentication/social-connections/slack"},{provider:"linear",strategy:"oauth_linear",name:"Linear",docsUrl:"https://clerk.com/docs/authentication/social-connections/linear"},{provider:"x",strategy:"oauth_x",name:"X / Twitter",docsUrl:"https://clerk.com/docs/authentication/social-connections/x-twitter-v2"},{provider:"enstall",strategy:"oauth_enstall",name:"Enstall",docsUrl:"https://clerk.com/docs/authentication/social-connections/enstall"},{provider:"huggingface",strategy:"oauth_huggingface",name:"Hugging Face",docsUrl:"https://clerk.com/docs/authentication/social-connections/huggingface"}],i={saml_okta:{name:"Okta Workforce",logo:"okta"},saml_google:{name:"Google Workspace",logo:"google"},saml_microsoft:{name:"Microsoft Entra ID (Formerly AD)",logo:"azure"},saml_custom:{name:"SAML",logo:"saml"}},n=[{provider:"metamask",strategy:"web3_metamask_signature",name:"MetaMask"},{provider:"coinbase_wallet",strategy:"web3_coinbase_wallet_signature",name:"Coinbase Wallet"}]},4814:function(e,o,t){t.d(o,{at:function(){return r.at}});var r=t(371);t(3781)}}]);