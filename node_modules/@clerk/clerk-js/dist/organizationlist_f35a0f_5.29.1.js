"use strict";(globalThis.webpackChunk_clerk_clerk_js=globalThis.webpackChunk_clerk_clerk_js||[]).push([[578],{2916:function(e,i,t){t.d(i,{A:function(){return m}});var n=t(4380),a=t(3931),o=t(4041),r=t(7362),l=t(9333),s=t(8369),c=t(8313),d=t(9513),u=t(9927),g=t(6912),h=t(2622),p=t(699),v=t(4683);const m=(0,s.withCardStateProvider)((e=>{var i,t;const m=(0,s.useCardState)(),z=(0,r.Xi)({onNextStep:()=>m.setError(void 0)}),S=o.useRef(null),{createOrganization:C,isLoaded:b,setActive:x,userMemberships:Y}=(0,a.D_)({userMemberships:v.mu.userMemberships}),{organization:$}=(0,a.Z5)(),[f,w]=o.useState(),y=(0,u.tJ)("name","",{type:"text",label:(0,d.GQ)("formFieldLabel__organizationName"),placeholder:(0,d.GQ)("formFieldInputPlaceholder__organizationName")}),P=(0,u.tJ)("slug","",{type:"text",label:(0,d.GQ)("formFieldLabel__organizationSlug"),placeholder:(0,d.GQ)("formFieldInputPlaceholder__organizationSlug")}),L=!!y.value,A=()=>{var i;e.navigateAfterCreateOrganization(S.current),null===(i=e.onComplete)||void 0===i||i.call(e)},D=e=>{P.setValue(e)},F="organizationList"===e.flow?"subtitle":void 0;return(0,n.FD)(r.sQ,{...z.props,children:[(0,n.Y)(s.FormContainer,{headerTitle:null===(i=null==e?void 0:e.startPage)||void 0===i?void 0:i.headerTitle,headerSubtitle:null===(t=null==e?void 0:e.startPage)||void 0===t?void 0:t.headerSubtitle,headerTitleTextVariant:"h2",headerSubtitleTextVariant:F,sx:e=>({minHeight:e.sizes.$60,gap:e.space.$6,textAlign:"left"}),children:(0,n.FD)(s.Form.Root,{onSubmit:async i=>{var t,n;if(i.preventDefault(),L&&b)try{const i={name:y.value};e.hideSlug||(i.slug=P.value);const a=await C(i);if(f&&await a.setLogo({file:f}),S.current=a,await x({organization:a}),null===(t=Y.revalidate)||void 0===t||t.call(Y),null!==(n=e.skipInvitationScreen)&&void 0!==n?n:1===a.maxAllowedMemberships)return A();z.nextStep()}catch(a){(0,u.H4)(a,[y,P],m.setError)}},sx:e=>({gap:e.space.$6}),children:[(0,n.Y)(l.Col,{children:(0,n.Y)(p.i,{organization:{name:y.value},onAvatarChange:async e=>await w(e),onAvatarRemove:f?()=>(m.setIdle(),w(null)):null,avatarPreviewPlaceholder:(0,n.Y)(s.IconButton,{variant:"ghost","aria-label":"Upload organization logo",icon:(0,n.Y)(l.Icon,{size:"md",icon:c._O,sx:e=>({color:e.colors.$colorTextSecondary,transitionDuration:e.transitionDuration.$controls})}),sx:e=>({width:e.sizes.$16,height:e.sizes.$16,borderRadius:e.radii.$md,borderWidth:e.borderWidths.$normal,borderStyle:e.borderStyles.$dashed,borderColor:e.colors.$neutralAlpha200,backgroundColor:e.colors.$neutralAlpha50,":hover":{backgroundColor:e.colors.$neutralAlpha50,svg:{transform:"scale(1.2)"}}})})})}),(0,n.Y)(s.Form.ControlRow,{elementId:y.id,children:(0,n.Y)(s.Form.PlainInput,{...y.props,onChange:e=>{y.setValue(e.target.value),D((0,u.e9)(e.target.value))},isRequired:!0,autoFocus:!0,ignorePasswordManager:!0})}),!e.hideSlug&&(0,n.Y)(s.Form.ControlRow,{elementId:P.id,children:(0,n.Y)(s.Form.PlainInput,{...P.props,onChange:e=>{D(e.target.value)},isRequired:!0,pattern:"^[a-z0-9\\-]+$",ignorePasswordManager:!0})}),(0,n.FD)(s.FormButtonContainer,{sx:e=>({marginTop:e.space.$none}),children:[(0,n.Y)(s.Form.SubmitButton,{block:!1,isDisabled:!L,localizationKey:(0,d.GQ)("createOrganization.formButtonSubmit")}),e.onCancel&&(0,n.Y)(s.Form.ResetButton,{localizationKey:(0,d.GQ)("userProfile.formButtonReset"),block:!1,onClick:e.onCancel})]})]})}),(0,n.Y)(s.FormContainer,{headerTitle:(0,d.GQ)("organizationProfile.invitePage.title"),headerTitleTextVariant:"h2",headerSubtitleTextVariant:F,sx:e=>({minHeight:e.sizes.$60,textAlign:"left"}),children:$&&(0,n.Y)(g.B,{resetButtonLabel:(0,d.GQ)("createOrganization.invitePage.formButtonReset"),onSuccess:z.nextStep,onReset:A})}),(0,n.FD)(l.Col,{children:[(0,n.Y)(s.Header.Root,{children:(0,n.Y)(s.Header.Title,{localizationKey:(0,d.GQ)("organizationProfile.invitePage.title"),sx:{textAlign:"left"}})}),(0,n.Y)(s.SuccessPage,{contents:(0,n.Y)(h.k,{}),sx:e=>({minHeight:e.sizes.$60}),onFinish:A})]})]})}))},8382:function(e,i,t){t.r(i),t.d(i,{OrganizationList:function(){return R}});var n=t(4380),a=t(844),o=t(9333),r=t(166),l=t(3931),s=t(4041),c=t(8369),d=t(5909),u=t(8313),g=t(2916),h=t(3965);const p=e=>(0,n.Y)(o.Col,{elementDescriptor:o.descriptors.organizationListPreviewItems,sx:e=>({maxHeight:`calc(8 * ${e.sizes.$12})`,overflowY:"auto",borderTopWidth:e.borderWidths.$normal,borderTopStyle:e.borderStyles.$solid,borderTopColor:e.colors.$neutralAlpha100,...h.common.unstyledScrollbar(e)}),children:e.children}),v=e=>({padding:`${e.space.$4} ${e.space.$5}`}),m=e=>({color:e.colors.$colorText,":hover":{color:e.colors.$colorText}}),z=e=>(0,n.FD)(o.Flex,{align:"center",gap:2,sx:[e=>({minHeight:"unset",justifyContent:"space-between",borderTopWidth:e.borderWidths.$normal,borderTopStyle:e.borderStyles.$solid,borderTopColor:e.colors.$neutralAlpha100}),v],elementDescriptor:o.descriptors.organizationListPreviewItem,children:[(0,n.Y)(c.OrganizationPreview,{elementId:"organizationList",mainIdentifierSx:m,organization:e.organizationData}),e.children]}),S=(0,s.forwardRef)(((e,i)=>(0,n.Y)(o.Box,{ref:i,sx:e=>({width:"100%",height:e.space.$12,position:"relative"}),children:(0,n.Y)(o.Box,{sx:{margin:"auto",position:"absolute",left:"50%",top:"50%",transform:"translateY(-50%) translateX(-50%)"},children:(0,n.Y)(o.Spinner,{size:"sm",colorScheme:"primary",elementDescriptor:o.descriptors.spinner})})}))),C=e=>(0,n.Y)(o.Button,{elementDescriptor:o.descriptors.organizationListPreviewItemActionButton,textVariant:"buttonSmall",variant:"outline",size:"xs",...e}),b=e=>(0,n.Y)(c.PreviewButton,{elementDescriptor:o.descriptors.organizationListPreviewButton,sx:[v],icon:u.yO,...e});var x=t(9927),Y=t(4683),$=t(9513);const f=(0,c.withCardStateProvider)((e=>{const i=(0,c.useCardState)(),{navigateAfterSelectOrganization:t}=(0,a.useOrganizationListContext)(),{isLoaded:o,setActive:r}=(0,l.D_)();return o?(0,n.Y)(b,{onClick:()=>{return n=e.organization,i.runAsync((async()=>{await r({organization:n}),await t(n)}));var n},children:(0,n.Y)(c.OrganizationPreview,{elementId:"organizationList",mainIdentifierSx:m,organization:e.organization})}):null})),w=(0,c.withCardStateProvider)((()=>{const e=(0,c.useCardState)(),{hidePersonal:i,navigateAfterSelectPersonal:t}=(0,a.useOrganizationListContext)(),{isLoaded:o,setActive:r}=(0,l.D_)(),{user:s}=(0,l.Jd)();if(!s)return null;const{username:d,primaryEmailAddress:u,primaryPhoneNumber:g,...h}=s;return i?null:(0,n.Y)(b,{onClick:()=>{if(o)return e.runAsync((async()=>{await r({organization:null}),await t(s)}))},children:(0,n.Y)(c.PersonalWorkspacePreview,{user:h,mainIdentifierSx:m,title:(0,$.GQ)("organizationSwitcher.personalWorkspace")})})})),y={userMemberships:{infinite:!0},userInvitations:{infinite:!0},userSuggestions:{infinite:!0,status:["pending","accepted"]}},P=e=>{const i=(0,c.useCardState)();return(0,n.Y)(C,{isLoading:i.isLoading,onClick:e.onAccept,localizationKey:(0,o.localizationKeys)("organizationList.action__invitationAccept")})},L=(0,c.withCardStateProvider)((e=>{const i=(0,c.useCardState)(),{getOrganization:t}=(0,l.ho)(),[a,o]=(0,s.useState)(null),{userInvitations:r}=(0,l.D_)({userInvitations:y.userInvitations,userMemberships:y.userMemberships});return a?(0,n.Y)(f,{organization:a}):(0,n.Y)(z,{organizationData:e.publicOrganizationData,children:(0,n.Y)(P,{onAccept:()=>i.runAsync((async()=>[await e.accept(),await t(e.publicOrganizationData.id)])).then((([e,i])=>{var t;null===(t=null==r?void 0:r.setData)||void 0===t||t.call(r,(i=>(0,Y.l_)(e,i,"negative"))),o(i)})).catch((e=>(0,x.H4)(e,[],i.setError)))})})})),A=e=>{const i=(0,c.useCardState)(),{userSuggestions:t}=(0,l.D_)({userSuggestions:y.userSuggestions});return"accepted"===e.status?(0,n.Y)(o.Text,{colorScheme:"secondary",localizationKey:(0,o.localizationKeys)("organizationList.suggestionsAcceptedLabel")}):(0,n.Y)(C,{isLoading:i.isLoading,onClick:()=>i.runAsync(e.accept).then((e=>{var i;return null===(i=null==t?void 0:t.setData)||void 0===i?void 0:i.call(t,(i=>(0,Y.l_)(e,i)))})).catch((e=>(0,x.H4)(e,[],i.setError))),localizationKey:(0,o.localizationKeys)("organizationList.action__suggestionsAccept")})},D=(0,c.withCardStateProvider)((e=>(0,n.Y)(z,{organizationData:e.publicOrganizationData,children:(0,n.Y)(A,{...e})}))),F=()=>{const{userMemberships:e,userInvitations:i,userSuggestions:t}=(0,l.D_)(y),{ref:n}=(0,d.Wx)({threshold:0,onChange:n=>{var a,o,r;n&&(e.hasNextPage?null===(a=e.fetchNext)||void 0===a||a.call(e):i.hasNextPage?null===(o=i.fetchNext)||void 0===o||o.call(i):null===(r=t.fetchNext)||void 0===r||r.call(t))}});return{userMemberships:e,userInvitations:i,userSuggestions:t,ref:n}},I=({onCreateOrganizationClick:e})=>{const{user:i}=(0,l.Jd)();return(null==i?void 0:i.createOrganizationEnabled)?(0,n.Y)(c.Action,{elementDescriptor:o.descriptors.organizationListCreateOrganizationActionButton,icon:u.OM,label:(0,o.localizationKeys)("organizationList.action__createOrganization"),onClick:e,sx:e=>({borderTopWidth:e.borderWidths.$normal,borderTopStyle:e.borderStyles.$solid,borderTopColor:e.colors.$neutralAlpha100,padding:`${e.space.$5} ${e.space.$5}`}),iconSx:e=>({width:e.sizes.$9,height:e.sizes.$6})}):null},O=(0,c.withCardStateProvider)((()=>{const e=(0,c.useCardState)(),{userMemberships:i,userSuggestions:t,userInvitations:r}=F(),l=(null==i?void 0:i.isLoading)||(null==r?void 0:r.isLoading)||(null==t?void 0:t.isLoading),s=!!((null==i?void 0:i.count)||(null==r?void 0:r.count)||(null==t?void 0:t.count)),{hidePersonal:d}=(0,a.useOrganizationListContext)();return(0,n.FD)(c.Card.Root,{children:[(0,n.FD)(c.Card.Content,{sx:e=>({padding:`${e.space.$8} ${e.space.$none} ${e.space.$none}`}),children:[(0,n.Y)(c.Card.Alert,{sx:e=>({margin:`${e.space.$none} ${e.space.$5}`}),children:e.error}),l&&(0,n.Y)(o.Flex,{direction:"row",align:"center",justify:"center",sx:e=>({height:"100%",minHeight:e.sizes.$60}),children:(0,n.Y)(o.Spinner,{size:"lg",colorScheme:"primary",elementDescriptor:o.descriptors.spinner})}),!l&&(0,n.Y)(_,{showListInitially:!(d&&!s)})]}),(0,n.Y)(c.Card.Footer,{})]})})),_=({showListInitially:e})=>{const{navigateAfterCreateOrganization:i,skipInvitationScreen:t,hideSlug:r}=(0,a.useOrganizationListContext)(),[l,c]=(0,s.useState)(!e);return(0,n.FD)(n.FK,{children:[!l&&(0,n.Y)(k,{onCreateOrganizationClick:()=>c(!0)}),l&&(0,n.Y)(o.Box,{sx:e=>({padding:`${e.space.$none} ${e.space.$5} ${e.space.$5}`}),children:(0,n.Y)(g.A,{flow:"organizationList",startPage:{headerTitle:(0,o.localizationKeys)("organizationList.createOrganization")},skipInvitationScreen:t,navigateAfterCreateOrganization:e=>i(e).then((()=>c(!1))),onCancel:e&&l?()=>c(!1):void 0,hideSlug:r})})]})},k=e=>{var i,t,r;const l=(0,a.useEnvironment)(),{ref:s,userMemberships:d,userSuggestions:u,userInvitations:g}=F(),{hidePersonal:h}=(0,a.useOrganizationListContext)(),v=(null==d?void 0:d.isLoading)||(null==g?void 0:g.isLoading)||(null==u?void 0:u.isLoading),m=(null==d?void 0:d.hasNextPage)||(null==g?void 0:g.hasNextPage)||(null==u?void 0:u.hasNextPage),z=null===(i=g.data)||void 0===i?void 0:i.filter((e=>!!e)),C=null===(t=u.data)||void 0===t?void 0:t.filter((e=>!!e));return(0,n.FD)(n.FK,{children:[(0,n.FD)(c.Header.Root,{sx:e=>({padding:`${e.space.$none} ${e.space.$8}`}),children:[(0,n.Y)(c.Header.Title,{localizationKey:(0,o.localizationKeys)(h?"organizationList.titleWithoutPersonal":"organizationList.title")}),(0,n.Y)(c.Header.Subtitle,{localizationKey:(0,o.localizationKeys)("organizationList.subtitle",{applicationName:l.displayConfig.applicationName})})]}),(0,n.Y)(o.Col,{elementDescriptor:o.descriptors.main,children:(0,n.Y)(p,{children:(0,n.FD)(c.Actions,{role:"menu",children:[(0,n.Y)(w,{}),(d.count||0)>0&&(null===(r=d.data)||void 0===r?void 0:r.map((e=>(0,n.Y)(f,{...e},e.id)))),!d.hasNextPage&&(null==z?void 0:z.map((e=>(0,n.Y)(L,{...e},e.id)))),!d.hasNextPage&&!g.hasNextPage&&(null==C?void 0:C.map((e=>(0,n.Y)(D,{...e},e.id)))),(m||v)&&(0,n.Y)(S,{ref:s}),(0,n.Y)(I,{onCreateOrganizationClick:()=>{e.onCreateOrganizationClick()}})]})})})]})},T=(0,a.withCoreUserGuard)(O),R=()=>(0,n.Y)(o.Flow.Root,{flow:"organizationList",children:(0,n.Y)(o.Flow.Part,{children:(0,n.Y)(r.Switch,{children:(0,n.Y)(r.Route,{children:(0,n.Y)(T,{})})})})})}}]);